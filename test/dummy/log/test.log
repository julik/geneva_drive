Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
GenevaDriveTest: test_it_has_a_version_number
---------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[36mActiveRecord::InternalMetadata Load (3.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[36mActiveRecord::SchemaMigration Load (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35mSQL (0.1ms)[0m  [1m[35mSET search_path TO public[0m
  [1m[35m (43.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "geneva_drive_test"[0m
  [1m[35m (96.9ms)[0m  [1m[35mCREATE DATABASE "geneva_drive_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (8.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql" SCHEMA pg_catalog[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "geneva_drive_step_executions" CASCADE[0m
  [1m[35m (3.6ms)[0m  [1m[35mCREATE TABLE "geneva_drive_step_executions" ("id" bigserial primary key, "canceled_at" timestamp(6), "completed_at" timestamp(6), "created_at" timestamp(6) NOT NULL, "error_backtrace" text, "error_message" text, "failed_at" timestamp(6), "job_id" character varying, "outcome" character varying, "scheduled_for" timestamp(6) NOT NULL, "skipped_at" timestamp(6), "started_at" timestamp(6), "state" character varying DEFAULT 'scheduled' NOT NULL, "step_name" character varying NOT NULL, "updated_at" timestamp(6) NOT NULL, "workflow_id" bigint NOT NULL)[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_geneva_drive_step_executions_on_scheduled_for" ON "geneva_drive_step_executions" ("scheduled_for")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_step_executions_scheduled" ON "geneva_drive_step_executions" ("state", "scheduled_for")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_geneva_drive_step_executions_on_state" ON "geneva_drive_step_executions" ("state")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "idx_on_workflow_id_created_at_af16a14fb2" ON "geneva_drive_step_executions" ("workflow_id", "created_at")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE INDEX "index_geneva_drive_step_executions_on_workflow_id_and_state" ON "geneva_drive_step_executions" ("workflow_id", "state")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_geneva_drive_step_executions_on_workflow_id" ON "geneva_drive_step_executions" ("workflow_id")[0m
  [1m[35m (0.5ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_step_executions_one_active_per_workflow" ON "geneva_drive_step_executions" ("workflow_id") WHERE ((state)::text = ANY ((ARRAY['scheduled'::character varying, 'executing'::character varying])::text[]))[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "geneva_drive_workflows" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "geneva_drive_workflows" ("id" bigserial primary key, "allow_multiple" boolean DEFAULT FALSE NOT NULL, "created_at" timestamp(6) NOT NULL, "current_step_name" character varying, "hero_id" bigint NOT NULL, "hero_type" character varying NOT NULL, "started_at" timestamp(6), "state" character varying DEFAULT 'ready' NOT NULL, "transitioned_at" timestamp(6), "type" character varying NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.7ms)[0m  [1m[35mCREATE INDEX "index_geneva_drive_workflows_on_hero_type_and_hero_id" ON "geneva_drive_workflows" ("hero_type", "hero_id")[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_geneva_drive_workflows_on_state" ON "geneva_drive_workflows" ("state")[0m
  [1m[35m (0.6ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_workflows_unique_active" ON "geneva_drive_workflows" ("type", "hero_type", "hero_id") WHERE (((state)::text <> ALL ((ARRAY['finished'::character varying, 'canceled'::character varying])::text[])) AND (allow_multiple = false))[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE INDEX "index_geneva_drive_workflows_on_type" ON "geneva_drive_workflows" ("type")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "active" boolean DEFAULT TRUE, "created_at" timestamp(6) NOT NULL, "email" character varying NOT NULL, "name" character varying, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "geneva_drive_step_executions" ADD CONSTRAINT "fk_rails_714b91b701"
FOREIGN KEY ("workflow_id")
  REFERENCES "geneva_drive_workflows" ("id")
[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20241217000002)[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20241217000001),
(20241217000000);[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'test', '2025-12-17 15:35:34.465171', '2025-12-17 15:35:34.465172') RETURNING "key"[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "environment"]]
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '38822fe124d4fbf0af8806fb2232a70ada80ef3d', '2025-12-17 15:35:34.466137', '2025-12-17 15:35:34.466138') RETURNING "key"[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_skip!_flow_control_skips_to_next_step
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (1.7ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.554267"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.554267"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (1.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.564698"], ["current_step_name", nil], ["hero_id", 1], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.564698"]]
  [1m[36mFlowControlTestWorkflow Load (0.5ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 1], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (1.9ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.580359"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.566151"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.580359"], ["workflow_id", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.582639"], ["id", 1]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3d96a1ec-53c1-4cb6-b0df-905636ce735d) to Test(default) with arguments: 1
  [1m[36mGenevaDrive::StepExecution Update (0.6ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3d96a1ec-53c1-4cb6-b0df-905636ce735d"], ["updated_at", "2025-12-17 15:35:34.603129"], ["id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (1.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.604791"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.604126"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_step"], ["updated_at", "2025-12-17 15:35:34.604791"], ["workflow_id", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_cancel!_flow_control_cancels_workflow
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.608766"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.608766"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.609458"], ["current_step_name", nil], ["hero_id", 2], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.609458"]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 2], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.610719"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.609822"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.610719"], ["workflow_id", 2]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.611416"], ["id", 2]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: b4b11974-7fdf-486a-9207-c18f12fa5467) to Test(default) with arguments: 3
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "b4b11974-7fdf-486a-9207-c18f12fa5467"], ["updated_at", "2025-12-17 15:35:34.612149"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.7ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.614703"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.614791"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.5ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 2], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.616130"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:35:34.618684"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:35:34.618776"], ["id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 2], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:35:34.619933"], ["updated_at", "2025-12-17 15:35:34.620003"], ["id", 2]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 2], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_pause!_flow_control_pauses_workflow
------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.621993"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.621993"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.622651"], ["current_step_name", nil], ["hero_id", 3], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.622651"]]
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 3], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.5ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.624261"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.623174"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.624261"], ["workflow_id", 3]]
  [1m[36mFlowControlTestWorkflow Update (0.5ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.624978"], ["id", 3]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c0481641-c47b-42e1-8a00-9af4e82adcfd) to Test(default) with arguments: 4
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c0481641-c47b-42e1-8a00-9af4e82adcfd"], ["updated_at", "2025-12-17 15:35:34.625692"], ["id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.5ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.626947"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.626367"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_step"], ["updated_at", "2025-12-17 15:35:34.626947"], ["workflow_id", 3]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
ExecutorTest: test_on_exception:_:skip!_skips_step_on_error
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.628771"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.628771"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.630724"], ["current_step_name", nil], ["hero_id", 4], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.630724"]]
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 4], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.632294"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.631303"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:35:34.632294"], ["workflow_id", 4]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:35:34.633020"], ["id", 4]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: ab36a6bd-db64-4c3e-9702-6bb128a47699) to Test(default) with arguments: 6
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "ab36a6bd-db64-4c3e-9702-6bb128a47699"], ["updated_at", "2025-12-17 15:35:34.633544"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 4], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.5ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.634580"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.634083"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_error"], ["updated_at", "2025-12-17 15:35:34.634580"], ["workflow_id", 4]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
ExecutorTest: test_skip_if_condition_evaluated_at_execution_time
----------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.636380"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.636380"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.637004"], ["email", "[FILTERED]"], ["name", "Skip"], ["updated_at", "2025-12-17 15:35:34.637004"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.642399"], ["current_step_name", nil], ["hero_id", 6], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SkipIfTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.642399"]]
  [1m[36mSkipIfTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 5], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.645198"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.643387"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skippable"], ["updated_at", "2025-12-17 15:35:34.645198"], ["workflow_id", 5]]
  [1m[36mSkipIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skippable"], ["updated_at", "2025-12-17 15:35:34.646149"], ["id", 5]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 548df490-5156-4809-8587-8e47d9753599) to Test(default) with arguments: 8
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "548df490-5156-4809-8587-8e47d9753599"], ["updated_at", "2025-12-17 15:35:34.646977"], ["id", 8]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 5], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.650337"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.650433"], ["id", 8]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 5], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.652974"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:35:34.655700"], ["state", "skipped"], ["updated_at", "2025-12-17 15:35:34.656264"], ["id", 8]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 5], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:35:34.658995"], ["id", 5]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 5], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.662386"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.659548"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "final"], ["updated_at", "2025-12-17 15:35:34.662386"], ["workflow_id", 5]]
  [1m[36mSkipIfTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "final"], ["updated_at", "2025-12-17 15:35:34.663036"], ["id", 5]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 26d1d7ad-7c3b-4bf8-9e43-c6498023e3cf) to Test(default) with arguments: 9
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "26d1d7ad-7c3b-4bf8-9e43-c6498023e3cf"], ["updated_at", "2025-12-17 15:35:34.663775"], ["id", 9]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkipIfTestWorkflow"], ["id", 5], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
ExecutorTest: test_cancel_if_condition_cancels_workflow
-------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.667144"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.667144"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.668119"], ["email", "[FILTERED]"], ["name", "Cancel"], ["updated_at", "2025-12-17 15:35:34.668119"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.670889"], ["current_step_name", nil], ["hero_id", 8], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "CancelIfTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.670889"]]
  [1m[36mCancelIfTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 6], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.672467"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.671443"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first"], ["updated_at", "2025-12-17 15:35:34.672467"], ["workflow_id", 6]]
  [1m[36mCancelIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first"], ["updated_at", "2025-12-17 15:35:34.673289"], ["id", 6]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 07e67fa2-e05f-4329-ad58-ba1e31e3fce4) to Test(default) with arguments: 10
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "07e67fa2-e05f-4329-ad58-ba1e31e3fce4"], ["updated_at", "2025-12-17 15:35:34.673815"], ["id", 10]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 6], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 10], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.675457"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.675545"], ["id", 10]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 6], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.676778"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 10], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:35:34.678191"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:35:34.678288"], ["id", 10]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 6], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:35:34.679606"], ["updated_at", "2025-12-17 15:35:34.679671"], ["id", 6]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "CancelIfTestWorkflow"], ["id", 6], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
ExecutorTest: test_proceeds_without_hero_if_may_proceed_without_hero!_is_set
----------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.681577"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.681577"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.683412"], ["current_step_name", nil], ["hero_id", 9], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HeroOptionalWorkflow"], ["updated_at", "2025-12-17 15:35:34.683412"]]
  [1m[36mHeroOptionalWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 7], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.684916"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.683949"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.684916"], ["workflow_id", 7]]
  [1m[36mHeroOptionalWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.685505"], ["id", 7]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 6346b9e8-d3f0-4968-88e3-96aea1c754fb) to Test(default) with arguments: 11
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "6346b9e8-d3f0-4968-88e3-96aea1c754fb"], ["updated_at", "2025-12-17 15:35:34.686015"], ["id", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 7], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 9]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 7], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.688512"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.688595"], ["id", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 7], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.689899"], ["id", 7]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 7], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:35:34.691232"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:35:34.691324"], ["id", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 7], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:35:34.692537"], ["id", 7]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 7], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:35:34.693585"], ["updated_at", "2025-12-17 15:35:34.693644"], ["id", 7]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 7], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
ExecutorTest: test_on_exception:_:cancel!_cancels_workflow_on_error
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.695636"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.695636"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.696314"], ["current_step_name", nil], ["hero_id", 10], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.696314"]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 8], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.697681"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.696849"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:35:34.697681"], ["workflow_id", 8]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:35:34.698084"], ["id", 8]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 1e76554f-37b7-4f25-900b-2147cbf3315f) to Test(default) with arguments: 12
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "1e76554f-37b7-4f25-900b-2147cbf3315f"], ["updated_at", "2025-12-17 15:35:34.698482"], ["id", 12]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 8], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.699254"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.698843"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:35:34.699254"], ["workflow_id", 8]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_cancels_workflow_if_hero_is_deleted
------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.700967"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.700967"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.702615"], ["current_step_name", nil], ["hero_id", 11], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "NoHeroTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.702615"]]
  [1m[36mNoHeroTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 9], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.703992"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.703101"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.703992"], ["workflow_id", 9]]
  [1m[36mNoHeroTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.704539"], ["id", 9]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 97daee7c-0a40-4ead-b264-7690ad9322c3) to Test(default) with arguments: 14
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "97daee7c-0a40-4ead-b264-7690ad9322c3"], ["updated_at", "2025-12-17 15:35:34.704948"], ["id", 14]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 9], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 9], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.706937"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.707022"], ["id", 14]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 9], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.708061"], ["id", 9]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:35:34.709267"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:35:34.709371"], ["id", 14]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 9], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:35:34.710211"], ["updated_at", "2025-12-17 15:35:34.710280"], ["id", 9]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 9], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------
ExecutorTest: test_on_exception:_:pause!_pauses_workflow_on_error
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.711643"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.711643"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.712156"], ["current_step_name", nil], ["hero_id", 12], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.712156"]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 10], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.713246"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.712534"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:35:34.713246"], ["workflow_id", 10]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:35:34.713692"], ["id", 10]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 5f4b0a4f-789e-448b-8bc4-81ef048999d0) to Test(default) with arguments: 15
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "5f4b0a4f-789e-448b-8bc4-81ef048999d0"], ["updated_at", "2025-12-17 15:35:34.714071"], ["id", 15]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.714950"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.714471"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:35:34.714950"], ["workflow_id", 10]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ExecutorTest: test_calls_before_step_starts_hook
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.716326"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.716326"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.717892"], ["current_step_name", nil], ["hero_id", 13], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HookTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.717892"]]
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 11], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.719165"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.718347"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "tracked_step"], ["updated_at", "2025-12-17 15:35:34.719165"], ["workflow_id", 11]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "tracked_step"], ["updated_at", "2025-12-17 15:35:34.719631"], ["id", 11]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 9b68432e-787c-486a-b8f3-5519cb1f2060) to Test(default) with arguments: 17
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "9b68432e-787c-486a-b8f3-5519cb1f2060"], ["updated_at", "2025-12-17 15:35:34.720071"], ["id", 17]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 11], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.721239"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.721333"], ["id", 17]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 11], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.722221"], ["id", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:35:34.723510"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:35:34.723594"], ["id", 17]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 11], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:35:34.724519"], ["id", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 11], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:35:34.725375"], ["updated_at", "2025-12-17 15:35:34.725433"], ["id", 11]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
ExecutorTest: test_finished!_flow_control_finishes_workflow_immediately
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.726333"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.726333"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.726850"], ["current_step_name", nil], ["hero_id", 14], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.726850"]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 12], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.727951"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.727238"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.727951"], ["workflow_id", 12]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:35:34.728402"], ["id", 12]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: fa2ececf-696c-43d6-b939-8cce28662bb4) to Test(default) with arguments: 18
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "fa2ececf-696c-43d6-b939-8cce28662bb4"], ["updated_at", "2025-12-17 15:35:34.728760"], ["id", 18]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.729577"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.729119"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "finish_step"], ["updated_at", "2025-12-17 15:35:34.729577"], ["workflow_id", 12]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------
ExecutorTest: test_step_execution_idempotency_-_does_not_re-execute_completed_step
----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.730955"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.730955"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.732479"], ["current_step_name", nil], ["hero_id", 15], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.732479"]]
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 13], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.733640"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.732869"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:35:34.733640"], ["workflow_id", 13]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:35:34.734066"], ["id", 13]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: a22ae264-3f5a-4e0c-a07b-9b7b6ba4e70e) to Test(default) with arguments: 20
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "a22ae264-3f5a-4e0c-a07b-9b7b6ba4e70e"], ["updated_at", "2025-12-17 15:35:34.734484"], ["id", 20]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 13], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.735534"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.735619"], ["id", 20]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 13], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.736461"], ["id", 13]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:35:34.737678"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:35:34.737763"], ["id", 20]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 13], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:35:34.738611"], ["id", 13]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 13], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.739727"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.738972"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:35:34.739727"], ["workflow_id", 13]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:35:34.740152"], ["id", 13]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7a8e1319-83b4-4bab-91f3-49a79fb852be) to Test(default) with arguments: 21
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7a8e1319-83b4-4bab-91f3-49a79fb852be"], ["updated_at", "2025-12-17 15:35:34.740514"], ["id", 21]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 13], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_executes_step_and_transitions_to_next
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.742235"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.742235"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.742734"], ["current_step_name", nil], ["hero_id", 16], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:35:34.742734"]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 14], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.743759"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.743086"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:35:34.743759"], ["workflow_id", 14]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:35:34.744191"], ["id", 14]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: af3b624a-d15b-475c-bfb6-20acb47d48a8) to Test(default) with arguments: 22
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "af3b624a-d15b-475c-bfb6-20acb47d48a8"], ["updated_at", "2025-12-17 15:35:34.744566"], ["id", 22]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 14], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:35:34.745612"], ["state", "executing"], ["updated_at", "2025-12-17 15:35:34.745697"], ["id", 22]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 14], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:35:34.746554"], ["id", 14]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:35:34.747727"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:35:34.747809"], ["id", 22]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 14], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:35:34.748635"], ["id", 14]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 14], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.749672"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.748976"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:35:34.749672"], ["workflow_id", 14]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:35:34.750079"], ["id", 14]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4359fd78-2ff7-4979-bac0-271b7af59301) to Test(default) with arguments: 23
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4359fd78-2ff7-4979-bac0-271b7af59301"], ["updated_at", "2025-12-17 15:35:34.750423"], ["id", 23]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 14], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 14]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
WorkflowTest: test_transitioned_at_is_set_when_transitioning_to_terminal_states
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.752611"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.752611"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.754121"], ["current_step_name", nil], ["hero_id", 17], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:35:34.754121"]]
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 15], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.755331"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.754531"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.755331"], ["workflow_id", 15]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.755788"], ["id", 15]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: fe95f569-8ea3-43d8-baac-1a7c26b66f4d) to Test(default) with arguments: 24
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "fe95f569-8ea3-43d8-baac-1a7c26b66f4d"], ["updated_at", "2025-12-17 15:35:34.756173"], ["id", 24]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 15], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:35:34.756914"], ["updated_at", "2025-12-17 15:35:34.756978"], ["id", 15]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
WorkflowTest: test_creates_workflow_with_hero_and_schedules_first_step
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.757860"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.757860"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.758334"], ["current_step_name", nil], ["hero_id", 18], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:35:34.758334"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 16], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.759398"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.758706"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.759398"], ["workflow_id", 16]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.759795"], ["id", 16]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c733b3d1-deb6-43ae-a6d0-600ec8cbf007) to Test(default) with arguments: 25
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c733b3d1-deb6-43ae-a6d0-600ec8cbf007"], ["updated_at", "2025-12-17 15:35:34.760183"], ["id", 25]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 16]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 16], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
WorkflowTest: test_scopes_work_correctly
----------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.761510"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.761510"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.762035"], ["current_step_name", nil], ["hero_id", 19], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:35:34.762035"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 17], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.763070"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.762394"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.763070"], ["workflow_id", 17]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.763489"], ["id", 17]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 47726e95-389f-47e0-8cff-d95b0d9fb72d) to Test(default) with arguments: 26
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "47726e95-389f-47e0-8cff-d95b0d9fb72d"], ["updated_at", "2025-12-17 15:35:34.763843"], ["id", 26]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", true], ["created_at", "2025-12-17 15:35:34.764280"], ["current_step_name", nil], ["hero_id", 19], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:35:34.764280"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 18], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.765350"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.764664"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.765350"], ["workflow_id", 18]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.765730"], ["id", 18]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: d20f2339-752c-4dbb-b236-25135f9fd3a7) to Test(default) with arguments: 27
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "d20f2339-752c-4dbb-b236-25135f9fd3a7"], ["updated_at", "2025-12-17 15:35:34.766106"], ["id", 27]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 18], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:35:34.766810"], ["updated_at", "2025-12-17 15:35:34.766879"], ["id", 18]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "ready"], ["id", 17], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "finished"], ["id", 18], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 17], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 18], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."hero_type" = $1 AND "geneva_drive_workflows"."hero_id" = $2[0m  [["hero_type", "User"], ["hero_id", 19]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
WorkflowTest: test_step_definitions_are_inherited
-------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.769222"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.769222"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_job_options_are_merged_from_parent
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.769970"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.769970"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_step_collection_provides_ordered_steps
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.770787"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.770787"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_may_proceed_without_hero!_is_inherited
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.771520"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.771520"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
WorkflowTest: test_step_collection_finds_next_step
--------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.772281"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.772281"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_cancel_if_conditions_are_inherited
-----------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.773010"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.773010"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_resume!_works_for_paused_workflows
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.773763"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.773763"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.774252"], ["current_step_name", nil], ["hero_id", 26], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:35:34.774252"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 19], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.775370"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.774628"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.775370"], ["workflow_id", 19]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.775768"], ["id", 19]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: fd03d674-30aa-4a08-8b1c-e09b32fc3364) to Test(default) with arguments: 28
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "fd03d674-30aa-4a08-8b1c-e09b32fc3364"], ["updated_at", "2025-12-17 15:35:34.776148"], ["id", 28]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 19], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:35:34.776911"], ["updated_at", "2025-12-17 15:35:34.776973"], ["id", 19]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 19], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "ready"], ["transitioned_at", nil], ["updated_at", "2025-12-17 15:35:34.777793"], ["id", 19]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 19], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.779334"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.778610"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.779334"], ["workflow_id", 19]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
WorkflowTest: test_workflow_with_wait_schedules_step_for_future
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.780779"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.780779"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.782350"], ["current_step_name", nil], ["hero_id", 27], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "WaitingWorkflow"], ["updated_at", "2025-12-17 15:35:34.782350"]]
  [1m[36mWaitingWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 20], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.783418"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.782716"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "immediate_step"], ["updated_at", "2025-12-17 15:35:34.783418"], ["workflow_id", 20]]
  [1m[36mWaitingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "immediate_step"], ["updated_at", "2025-12-17 15:35:34.783811"], ["id", 20]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: cba17895-4bd8-487e-8f25-a5dc1a130cb8) to Test(default) with arguments: 30
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "cba17895-4bd8-487e-8f25-a5dc1a130cb8"], ["updated_at", "2025-12-17 15:35:34.784207"], ["id", 30]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 20], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 30], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:35:34.785245"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:35:34.785342"], ["id", 30]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 20], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 20], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.787089"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-19 15:35:34.786316"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "delayed_step"], ["updated_at", "2025-12-17 15:35:34.787089"], ["workflow_id", 20]]
  [1m[36mWaitingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "delayed_step"], ["updated_at", "2025-12-17 15:35:34.787496"], ["id", 20]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: f5551d3b-9b35-4455-9b7a-fde0978c0c77) to Test(default) at 2025-12-19 15:35:34 UTC with arguments: 31
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "f5551d3b-9b35-4455-9b7a-fde0978c0c77"], ["updated_at", "2025-12-17 15:35:34.787872"], ["id", 31]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" DESC LIMIT $2[0m  [["workflow_id", 20], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
WorkflowTest: test_resume!_raises_for_non-paused_workflows
----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:35:34.789129"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:35:34.789129"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:35:34.789584"], ["current_step_name", nil], ["hero_id", 28], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:35:34.789584"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 21], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:35:34.790651"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:35:34.789950"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.790651"], ["workflow_id", 21]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:35:34.791059"], ["id", 21]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 11d5b9f0-8e66-41ca-bc35-ca1cde86f3d7) to Test(default) with arguments: 32
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "11d5b9f0-8e66-41ca-bc35-ca1cde86f3d7"], ["updated_at", "2025-12-17 15:35:34.791445"], ["id", 32]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
GenevaDriveTest: test_it_has_a_version_number
---------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[36mActiveRecord::InternalMetadata Load (1.6ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
GenevaDriveTest: test_it_has_a_version_number
---------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
WorkflowTest: test_workflow_with_wait_schedules_step_for_future
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.8ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.387975"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.387975"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Create (0.8ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.397625"], ["current_step_name", nil], ["hero_id", 29], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "WaitingWorkflow"], ["updated_at", "2025-12-17 15:36:08.397625"]]
  [1m[36mWaitingWorkflow Load (1.0ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 22], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (2.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 22], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.8ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.415447"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.398723"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "immediate_step"], ["updated_at", "2025-12-17 15:36:08.415447"], ["workflow_id", 22]]
  [1m[36mWaitingWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "immediate_step"], ["updated_at", "2025-12-17 15:36:08.416555"], ["id", 22]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 75880a71-0309-47ce-87cc-641071ea261c) to Test(default) with arguments: 33
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "75880a71-0309-47ce-87cc-641071ea261c"], ["updated_at", "2025-12-17 15:36:08.429151"], ["id", 33]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 22], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.5ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 33], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.5ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:36:08.436997"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:36:08.437123"], ["id", 33]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 22], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 22], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 22], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.440985"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-19 15:36:08.439171"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "delayed_step"], ["updated_at", "2025-12-17 15:36:08.440985"], ["workflow_id", 22]]
  [1m[36mWaitingWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "delayed_step"], ["updated_at", "2025-12-17 15:36:08.441682"], ["id", 22]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c230e217-4ac4-4f2c-a01a-8ac36677f863) to Test(default) at 2025-12-19 15:36:08 UTC with arguments: 34
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c230e217-4ac4-4f2c-a01a-8ac36677f863"], ["updated_at", "2025-12-17 15:36:08.442480"], ["id", 34]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" DESC LIMIT $2[0m  [["workflow_id", 22], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_step_collection_provides_ordered_steps
---------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.444302"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.444302"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_cancel_if_conditions_are_inherited
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.445298"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.445298"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_may_proceed_without_hero!_is_inherited
---------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.446349"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.446349"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
WorkflowTest: test_transitioned_at_is_set_when_transitioning_to_terminal_states
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.447397"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.447397"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.449342"], ["current_step_name", nil], ["hero_id", 33], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:36:08.449342"]]
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 23], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 23], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.451405"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.449919"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.451405"], ["workflow_id", 23]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.452179"], ["id", 23]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 5c9dcee2-c553-4dc9-86f5-b0c3c2a2eeb1) to Test(default) with arguments: 35
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "5c9dcee2-c553-4dc9-86f5-b0c3c2a2eeb1"], ["updated_at", "2025-12-17 15:36:08.452617"], ["id", 35]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 23], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:36:08.453631"], ["updated_at", "2025-12-17 15:36:08.453708"], ["id", 23]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_resume!_works_for_paused_workflows
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.454839"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.454839"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.455513"], ["current_step_name", nil], ["hero_id", 34], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:36:08.455513"]]
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 24], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 24], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 24], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.457746"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.456077"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.457746"], ["workflow_id", 24]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.458264"], ["id", 24]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: b5380e1a-b48b-4ec8-a6e9-feb39063e549) to Test(default) with arguments: 36
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "b5380e1a-b48b-4ec8-a6e9-feb39063e549"], ["updated_at", "2025-12-17 15:36:08.458691"], ["id", 36]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 24], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:36:08.459638"], ["updated_at", "2025-12-17 15:36:08.459712"], ["id", 24]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 24], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "ready"], ["transitioned_at", nil], ["updated_at", "2025-12-17 15:36:08.460761"], ["id", 24]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 24], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 24], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 36], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:36:08.462817"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:36:08.462917"], ["id", 36]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 24], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.463818"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.461212"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.463818"], ["workflow_id", 24]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 8743c9a9-fe6e-434e-b252-48d637e8d9d8) to Test(default) with arguments: 37
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "8743c9a9-fe6e-434e-b252-48d637e8d9d8"], ["updated_at", "2025-12-17 15:36:08.464475"], ["id", 37]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 24]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
WorkflowTest: test_resume!_raises_for_non-paused_workflows
----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.465958"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.465958"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.466511"], ["current_step_name", nil], ["hero_id", 35], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:36:08.466511"]]
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 25], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 25], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 25], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.468534"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.466981"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.468534"], ["workflow_id", 25]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.469034"], ["id", 25]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 59b9e710-f7fe-49c7-b7b2-fe9e797ba5aa) to Test(default) with arguments: 38
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "59b9e710-f7fe-49c7-b7b2-fe9e797ba5aa"], ["updated_at", "2025-12-17 15:36:08.469418"], ["id", 38]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_job_options_are_merged_from_parent
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.470258"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.470258"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
WorkflowTest: test_step_definitions_are_inherited
-------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.471091"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.471091"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
WorkflowTest: test_step_collection_finds_next_step
--------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.471966"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.471966"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
WorkflowTest: test_creates_workflow_with_hero_and_schedules_first_step
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.472909"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.472909"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.473361"], ["current_step_name", nil], ["hero_id", 39], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:36:08.473361"]]
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 26], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 26], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.475670"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.473714"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.475670"], ["workflow_id", 26]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.477039"], ["id", 26]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7c164c68-f980-4924-a345-078b8a577079) to Test(default) with arguments: 39
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7c164c68-f980-4924-a345-078b8a577079"], ["updated_at", "2025-12-17 15:36:08.477816"], ["id", 39]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 26]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 26], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
WorkflowTest: test_scopes_work_correctly
----------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.480755"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.480755"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.482212"], ["current_step_name", nil], ["hero_id", 40], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:36:08.482212"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 27], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 27], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 27], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.486150"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.482610"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.486150"], ["workflow_id", 27]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.486949"], ["id", 27]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 15e43d0e-f673-4294-81ec-9f7dc43db06d) to Test(default) with arguments: 40
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "15e43d0e-f673-4294-81ec-9f7dc43db06d"], ["updated_at", "2025-12-17 15:36:08.487834"], ["id", 40]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", true], ["created_at", "2025-12-17 15:36:08.488305"], ["current_step_name", nil], ["hero_id", 40], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:36:08.488305"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 28], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 28], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.491448"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.489092"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.491448"], ["workflow_id", 28]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.492836"], ["id", 28]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 20363562-3330-4cb4-9278-7d0831ea34da) to Test(default) with arguments: 41
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "20363562-3330-4cb4-9278-7d0831ea34da"], ["updated_at", "2025-12-17 15:36:08.493787"], ["id", 41]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.6ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 28], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:36:08.495370"], ["updated_at", "2025-12-17 15:36:08.495451"], ["id", 28]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "ready"], ["id", 27], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "finished"], ["id", 28], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 27], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 28], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."hero_type" = $1 AND "geneva_drive_workflows"."hero_id" = $2[0m  [["hero_type", "User"], ["hero_id", 40]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_cancels_workflow_if_hero_is_deleted
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.500379"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.500379"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.504213"], ["current_step_name", nil], ["hero_id", 41], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "NoHeroTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.504213"]]
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 29], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 29], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 29], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.506280"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.504753"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.506280"], ["workflow_id", 29]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.506720"], ["id", 29]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: d19fe085-55bf-4ba5-8e6b-3e300e6fee1f) to Test(default) with arguments: 42
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "d19fe085-55bf-4ba5-8e6b-3e300e6fee1f"], ["updated_at", "2025-12-17 15:36:08.507141"], ["id", 42]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 29], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 41]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 29], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 42], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.509594"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.509679"], ["id", 42]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 29], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.510579"], ["id", 29]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 41], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 42], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:36:08.511843"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:36:08.511942"], ["id", 42]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 29], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:36:08.512691"], ["updated_at", "2025-12-17 15:36:08.512759"], ["id", 29]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 42], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 29], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
ExecutorTest: test_proceeds_without_hero_if_may_proceed_without_hero!_is_set
----------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.514231"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.514231"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.515904"], ["current_step_name", nil], ["hero_id", 42], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HeroOptionalWorkflow"], ["updated_at", "2025-12-17 15:36:08.515904"]]
  [1m[36mHeroOptionalWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 30], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 30], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 30], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.517553"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.516284"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.517553"], ["workflow_id", 30]]
  [1m[36mHeroOptionalWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:36:08.517986"], ["id", 30]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 6370b6c6-b9c8-4791-a932-c0a538a40a3d) to Test(default) with arguments: 43
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "6370b6c6-b9c8-4791-a932-c0a538a40a3d"], ["updated_at", "2025-12-17 15:36:08.518377"], ["id", 43]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 30], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 42]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 30], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 43], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.520063"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.520147"], ["id", 43]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 30], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.521004"], ["id", 30]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 30], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 43], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:36:08.522093"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:36:08.522179"], ["id", 43]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 30], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:36:08.523304"], ["id", 30]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 30], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:36:08.524069"], ["updated_at", "2025-12-17 15:36:08.524134"], ["id", 30]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 43], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 30], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------
ExecutorTest: test_step_execution_idempotency_-_does_not_re-execute_completed_step
----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.525546"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.525546"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.527215"], ["current_step_name", nil], ["hero_id", 43], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.527215"]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 31], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 31], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 31], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.528891"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.527603"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:36:08.528891"], ["workflow_id", 31]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:36:08.529314"], ["id", 31]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 0dadab57-18c2-4db1-a51e-7bd644a9dc99) to Test(default) with arguments: 44
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "0dadab57-18c2-4db1-a51e-7bd644a9dc99"], ["updated_at", "2025-12-17 15:36:08.529717"], ["id", 44]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 31], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 44], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.530789"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.530886"], ["id", 44]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 31], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.531718"], ["id", 31]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 43], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 31], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 44], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:36:08.532895"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:36:08.532984"], ["id", 44]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 31], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:36:08.533777"], ["id", 31]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 31], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 31], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 31], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.535274"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.534139"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:36:08.535274"], ["workflow_id", 31]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:36:08.535704"], ["id", 31]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4f4de91c-a350-4000-ab6f-6d2129f8e503) to Test(default) with arguments: 45
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4f4de91c-a350-4000-ab6f-6d2129f8e503"], ["updated_at", "2025-12-17 15:36:08.536075"], ["id", 45]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 31], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 44], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 44], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
ExecutorTest: test_on_exception:_:skip!_skips_step_on_error
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.537909"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.537909"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.539524"], ["current_step_name", nil], ["hero_id", 44], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.539524"]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 32], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 32], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 32], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.541083"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.539919"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:36:08.541083"], ["workflow_id", 32]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:36:08.541484"], ["id", 32]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3bf8b87d-6330-4e18-a6ed-1fda30c6dbb1) to Test(default) with arguments: 46
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3bf8b87d-6330-4e18-a6ed-1fda30c6dbb1"], ["updated_at", "2025-12-17 15:36:08.541878"], ["id", 46]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 32], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.542761"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.542232"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_error"], ["updated_at", "2025-12-17 15:36:08.542761"], ["workflow_id", 32]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_pause!_flow_control_pauses_workflow
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.544514"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.544514"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.546246"], ["current_step_name", nil], ["hero_id", 45], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.546246"]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 33], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 33], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.548035"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.546664"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.548035"], ["workflow_id", 33]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.548452"], ["id", 33]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 5caad995-c855-4df9-a59a-c6475a70fdf4) to Test(default) with arguments: 48
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "5caad995-c855-4df9-a59a-c6475a70fdf4"], ["updated_at", "2025-12-17 15:36:08.548862"], ["id", 48]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.549703"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.549237"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_step"], ["updated_at", "2025-12-17 15:36:08.549703"], ["workflow_id", 33]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ExecutorTest: test_calls_before_step_starts_hook
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.551080"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.551080"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.552608"], ["current_step_name", nil], ["hero_id", 46], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HookTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.552608"]]
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 34], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 34], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 34], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.554203"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.553022"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "tracked_step"], ["updated_at", "2025-12-17 15:36:08.554203"], ["workflow_id", 34]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "tracked_step"], ["updated_at", "2025-12-17 15:36:08.554617"], ["id", 34]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c8d1bf75-bb1e-4e8d-b134-58e16db4a5db) to Test(default) with arguments: 50
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c8d1bf75-bb1e-4e8d-b134-58e16db4a5db"], ["updated_at", "2025-12-17 15:36:08.555004"], ["id", 50]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 34], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 50], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.556128"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.556212"], ["id", 50]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 34], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.557071"], ["id", 34]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 46], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 34], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 50], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:36:08.558288"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:36:08.558371"], ["id", 50]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 34], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:36:08.559248"], ["id", 34]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 34], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:36:08.559994"], ["updated_at", "2025-12-17 15:36:08.560056"], ["id", 34]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
ExecutorTest: test_skip_if_condition_evaluated_at_execution_time
----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.560852"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.560852"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.561281"], ["email", "[FILTERED]"], ["name", "Skip"], ["updated_at", "2025-12-17 15:36:08.561281"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.562843"], ["current_step_name", nil], ["hero_id", 48], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SkipIfTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.562843"]]
  [1m[36mSkipIfTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 35], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 35], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 35], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.564509"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.563280"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skippable"], ["updated_at", "2025-12-17 15:36:08.564509"], ["workflow_id", 35]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skippable"], ["updated_at", "2025-12-17 15:36:08.564983"], ["id", 35]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: da2b850d-51f9-484b-8cee-119e41c17705) to Test(default) with arguments: 51
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "da2b850d-51f9-484b-8cee-119e41c17705"], ["updated_at", "2025-12-17 15:36:08.565360"], ["id", 51]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 35], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 51], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.566383"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.566469"], ["id", 51]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 35], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.567252"], ["id", 35]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 48], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 35], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 51], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:36:08.568493"], ["state", "skipped"], ["updated_at", "2025-12-17 15:36:08.568580"], ["id", 51]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 35], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:36:08.569420"], ["id", 35]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 35], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 35], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 35], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.570934"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.569783"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "final"], ["updated_at", "2025-12-17 15:36:08.570934"], ["workflow_id", 35]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "final"], ["updated_at", "2025-12-17 15:36:08.571341"], ["id", 35]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 72870d5b-c3c4-4512-81ab-c04ed7212f47) to Test(default) with arguments: 52
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "72870d5b-c3c4-4512-81ab-c04ed7212f47"], ["updated_at", "2025-12-17 15:36:08.571691"], ["id", 52]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 51], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkipIfTestWorkflow"], ["id", 35], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
ExecutorTest: test_finished!_flow_control_finishes_workflow_immediately
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.573047"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.573047"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.573566"], ["current_step_name", nil], ["hero_id", 49], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.573566"]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 36], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 36], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 36], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.575044"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.573950"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.575044"], ["workflow_id", 36]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.575446"], ["id", 36]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 2c9b4d96-86d3-4042-9854-04af9204a54e) to Test(default) with arguments: 53
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "2c9b4d96-86d3-4042-9854-04af9204a54e"], ["updated_at", "2025-12-17 15:36:08.575800"], ["id", 53]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 36], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.576607"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.576170"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "finish_step"], ["updated_at", "2025-12-17 15:36:08.576607"], ["workflow_id", 36]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_executes_step_and_transitions_to_next
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.578015"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.578015"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.578489"], ["current_step_name", nil], ["hero_id", 50], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.578489"]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 37], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 37], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 37], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.579992"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.578857"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:36:08.579992"], ["workflow_id", 37]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:36:08.580405"], ["id", 37]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: d7c499c2-6703-428f-a7f2-deac60164d83) to Test(default) with arguments: 55
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "d7c499c2-6703-428f-a7f2-deac60164d83"], ["updated_at", "2025-12-17 15:36:08.580782"], ["id", 55]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 37], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.581819"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.581923"], ["id", 55]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 37], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.582800"], ["id", 37]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 50], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 37], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:36:08.584004"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:36:08.584096"], ["id", 55]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 37], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:36:08.584924"], ["id", 37]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 37], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 37], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 37], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.586465"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.585288"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:36:08.586465"], ["workflow_id", 37]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:36:08.586884"], ["id", 37]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: aae8c075-6e13-4d05-a7c6-506862b26822) to Test(default) with arguments: 56
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "aae8c075-6e13-4d05-a7c6-506862b26822"], ["updated_at", "2025-12-17 15:36:08.587251"], ["id", 56]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 37], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 37]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
ExecutorTest: test_cancel_if_condition_cancels_workflow
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.588874"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.588874"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.589297"], ["email", "[FILTERED]"], ["name", "Cancel"], ["updated_at", "2025-12-17 15:36:08.589297"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.590951"], ["current_step_name", nil], ["hero_id", 52], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "CancelIfTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.590951"]]
  [1m[36mCancelIfTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 38], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 38], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 38], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.592501"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.591348"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first"], ["updated_at", "2025-12-17 15:36:08.592501"], ["workflow_id", 38]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first"], ["updated_at", "2025-12-17 15:36:08.592908"], ["id", 38]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 0131160e-bd05-4a2d-9679-0ed96ad30f2c) to Test(default) with arguments: 57
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "0131160e-bd05-4a2d-9679-0ed96ad30f2c"], ["updated_at", "2025-12-17 15:36:08.593264"], ["id", 57]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 38], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 57], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.594298"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.594381"], ["id", 57]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 38], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.595196"], ["id", 38]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 52], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 57], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:36:08.596203"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:36:08.596286"], ["id", 57]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 38], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:36:08.597075"], ["updated_at", "2025-12-17 15:36:08.597147"], ["id", 38]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 57], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "CancelIfTestWorkflow"], ["id", 38], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_skip!_flow_control_skips_to_next_step
--------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.598475"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.598475"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.598974"], ["current_step_name", nil], ["hero_id", 53], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.598974"]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 39], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 39], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 39], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.600484"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.599313"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.600484"], ["workflow_id", 39]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.600917"], ["id", 39]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: eaa8fbee-2000-418b-8e28-aa942d0e8b16) to Test(default) with arguments: 58
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "eaa8fbee-2000-418b-8e28-aa942d0e8b16"], ["updated_at", "2025-12-17 15:36:08.601277"], ["id", 58]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 39], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.602087"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.601661"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_step"], ["updated_at", "2025-12-17 15:36:08.602087"], ["workflow_id", 39]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------
ExecutorTest: test_on_exception:_:pause!_pauses_workflow_on_error
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.603441"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.603441"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.603922"], ["current_step_name", nil], ["hero_id", 54], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.603922"]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 40], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 40], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 40], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.605456"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.604287"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:36:08.605456"], ["workflow_id", 40]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:36:08.605868"], ["id", 40]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: a590521c-a89f-4f30-aac9-4282d78716e7) to Test(default) with arguments: 60
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "a590521c-a89f-4f30-aac9-4282d78716e7"], ["updated_at", "2025-12-17 15:36:08.606239"], ["id", 60]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 40], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.607034"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.606594"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:36:08.607034"], ["workflow_id", 40]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_cancel!_flow_control_cancels_workflow
--------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.608421"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.608421"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.608869"], ["current_step_name", nil], ["hero_id", 55], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.608869"]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 41], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 41], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 41], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.610346"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.609231"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.610346"], ["workflow_id", 41]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:36:08.610747"], ["id", 41]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 89d9f967-84ee-4982-980b-2ab109f2cf37) to Test(default) with arguments: 62
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "89d9f967-84ee-4982-980b-2ab109f2cf37"], ["updated_at", "2025-12-17 15:36:08.611099"], ["id", 62]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 41], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 62], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:36:08.612141"], ["state", "executing"], ["updated_at", "2025-12-17 15:36:08.612223"], ["id", 62]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 41], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:36:08.613071"], ["id", 41]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 41], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 62], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:36:08.614219"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:36:08.614301"], ["id", 62]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 41], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:36:08.615065"], ["updated_at", "2025-12-17 15:36:08.615126"], ["id", 41]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 62], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 41], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
ExecutorTest: test_on_exception:_:cancel!_cancels_workflow_on_error
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:36:08.616350"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:36:08.616350"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:36:08.616801"], ["current_step_name", nil], ["hero_id", 56], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:36:08.616801"]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 42], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 42], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 42], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.618244"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.617148"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:36:08.618244"], ["workflow_id", 42]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:36:08.618655"], ["id", 42]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 8af27d80-95dd-45d5-bd98-9b7a34cdc5d9) to Test(default) with arguments: 63
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "8af27d80-95dd-45d5-bd98-9b7a34cdc5d9"], ["updated_at", "2025-12-17 15:36:08.619017"], ["id", 63]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 42], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:36:08.619869"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:36:08.619403"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:36:08.619869"], ["workflow_id", 42]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[36mActiveRecord::InternalMetadata Load (1.8ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
ExecutorTest: test_cancel_if_condition_cancels_workflow
-------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.9ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.481782"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.481782"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.484107"], ["email", "[FILTERED]"], ["name", "Cancel"], ["updated_at", "2025-12-17 15:37:07.484107"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Create (0.9ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.491338"], ["current_step_name", nil], ["hero_id", 58], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "CancelIfTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.491338"]]
  [1m[36mCancelIfTestWorkflow Load (0.9ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 43], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (3.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 43], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.7ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 43], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (1.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.510077"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.492500"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first"], ["updated_at", "2025-12-17 15:37:07.510077"], ["workflow_id", 43]]
  [1m[36mCancelIfTestWorkflow Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first"], ["updated_at", "2025-12-17 15:37:07.511629"], ["id", 43]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c9444d40-6301-4c4c-820e-cdfeb81e6f44) to Test(default) with arguments: 65
  [1m[36mGenevaDrive::StepExecution Update (0.7ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c9444d40-6301-4c4c-820e-cdfeb81e6f44"], ["updated_at", "2025-12-17 15:37:07.524317"], ["id", 65]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 43], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.6ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 65], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.5ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.533000"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.533129"], ["id", 65]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.5ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 43], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.534666"], ["id", 43]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 58], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.5ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 65], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.536824"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.536912"], ["id", 65]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 43], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:37:07.538215"], ["updated_at", "2025-12-17 15:37:07.538280"], ["id", 43]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 65], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "CancelIfTestWorkflow"], ["id", 43], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
ExecutorTest: test_skip_if_condition_evaluated_at_execution_time
----------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.542301"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.542301"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.542990"], ["email", "[FILTERED]"], ["name", "Skip"], ["updated_at", "2025-12-17 15:37:07.542990"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.545059"], ["current_step_name", nil], ["hero_id", 60], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SkipIfTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.545059"]]
  [1m[36mSkipIfTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 44], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 44], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 44], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.547578"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.545672"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skippable"], ["updated_at", "2025-12-17 15:37:07.547578"], ["workflow_id", 44]]
  [1m[36mSkipIfTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skippable"], ["updated_at", "2025-12-17 15:37:07.548286"], ["id", 44]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 319d9e13-4c69-4b6d-92b1-1184227aaaa3) to Test(default) with arguments: 66
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "319d9e13-4c69-4b6d-92b1-1184227aaaa3"], ["updated_at", "2025-12-17 15:37:07.548855"], ["id", 66]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 44], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 66], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.550783"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.550874"], ["id", 66]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 44], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.552112"], ["id", 44]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 60], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 44], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 66], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:37:07.554116"], ["state", "skipped"], ["updated_at", "2025-12-17 15:37:07.554202"], ["id", 66]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 44], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:37:07.555621"], ["id", 44]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 44], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.5ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 44], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 44], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.558040"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.556201"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "final"], ["updated_at", "2025-12-17 15:37:07.558040"], ["workflow_id", 44]]
  [1m[36mSkipIfTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "final"], ["updated_at", "2025-12-17 15:37:07.558653"], ["id", 44]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 0a082220-305f-4629-9791-a29adbeab035) to Test(default) with arguments: 67
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "0a082220-305f-4629-9791-a29adbeab035"], ["updated_at", "2025-12-17 15:37:07.559146"], ["id", 67]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 66], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkipIfTestWorkflow"], ["id", 44], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ExecutorTest: test_calls_before_step_starts_hook
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.560910"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.560910"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.562707"], ["current_step_name", nil], ["hero_id", 61], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HookTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.562707"]]
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 45], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 45], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 45], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.564860"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.563247"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "tracked_step"], ["updated_at", "2025-12-17 15:37:07.564860"], ["workflow_id", 45]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "tracked_step"], ["updated_at", "2025-12-17 15:37:07.565396"], ["id", 45]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 23c4970a-d89c-4255-ab3b-9c1fadf21cae) to Test(default) with arguments: 68
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "23c4970a-d89c-4255-ab3b-9c1fadf21cae"], ["updated_at", "2025-12-17 15:37:07.565854"], ["id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 45], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.567219"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.567306"], ["id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 45], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.568310"], ["id", 45]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 61], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 45], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:37:07.569874"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:37:07.569961"], ["id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 45], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:37:07.571967"], ["id", 45]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 45], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:37:07.573248"], ["updated_at", "2025-12-17 15:37:07.573624"], ["id", 45]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
ExecutorTest: test_on_exception:_:skip!_skips_step_on_error
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.575255"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.575255"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.582600"], ["current_step_name", nil], ["hero_id", 62], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.582600"]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 46], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 46], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 46], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.588165"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.583321"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:37:07.588165"], ["workflow_id", 46]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:37:07.588738"], ["id", 46]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 9eb1b8ba-fc4d-4397-b765-8bd6a75912a3) to Test(default) with arguments: 69
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "9eb1b8ba-fc4d-4397-b765-8bd6a75912a3"], ["updated_at", "2025-12-17 15:37:07.589660"], ["id", 69]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 46], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 69], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.592370"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.592741"], ["id", 69]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 46], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.5ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.594394"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.593167"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_error"], ["updated_at", "2025-12-17 15:37:07.594394"], ["workflow_id", 46]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skip_error"], ["updated_at", "2025-12-17 15:37:07.596548"], ["id", 46]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 70], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.597991"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.598083"], ["id", 70]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 46], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.599895"], ["id", 46]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 62], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 46], ["LIMIT", 1]]
Step execution 70 failed: skip error
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.6ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 70], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (5.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:37:07.602097"], ["state", "skipped"], ["updated_at", "2025-12-17 15:37:07.602191"], ["id", 70]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 46], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:37:07.608254"], ["id", 46]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 46], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 46], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 46], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.611004"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.608749"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:37:07.611004"], ["workflow_id", 46]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_error"], ["updated_at", "2025-12-17 15:37:07.611628"], ["id", 46]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: cc275e3d-5b35-4311-a718-43831982c8fc) to Test(default) with arguments: 71
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "cc275e3d-5b35-4311-a718-43831982c8fc"], ["updated_at", "2025-12-17 15:37:07.612145"], ["id", 71]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 70], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 46], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_skip!_flow_control_skips_to_next_step
--------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.614037"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.614037"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.616128"], ["current_step_name", nil], ["hero_id", 63], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.616128"]]
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 47], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 47], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 47], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.618603"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.616705"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.618603"], ["workflow_id", 47]]
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.619301"], ["id", 47]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 67505990-bc47-4380-a0f7-f7d6df979620) to Test(default) with arguments: 72
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "67505990-bc47-4380-a0f7-f7d6df979620"], ["updated_at", "2025-12-17 15:37:07.619941"], ["id", 72]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 47], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 72], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.621890"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.621998"], ["id", 72]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 47], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.623112"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.622490"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_step"], ["updated_at", "2025-12-17 15:37:07.623112"], ["workflow_id", 47]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skip_step"], ["updated_at", "2025-12-17 15:37:07.623937"], ["id", 47]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 73], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.624934"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.625053"], ["id", 73]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 47], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.626052"], ["id", 47]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 63], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 47], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 73], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:37:07.627978"], ["state", "skipped"], ["updated_at", "2025-12-17 15:37:07.628086"], ["id", 73]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 47], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:37:07.629449"], ["id", 47]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.5ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 47], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 47], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 47], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.632011"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.630059"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "reattempt_step"], ["updated_at", "2025-12-17 15:37:07.632011"], ["workflow_id", 47]]
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "reattempt_step"], ["updated_at", "2025-12-17 15:37:07.632717"], ["id", 47]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: fd026857-beb5-4c57-ac03-6a3590af8f73) to Test(default) with arguments: 74
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "fd026857-beb5-4c57-ac03-6a3590af8f73"], ["updated_at", "2025-12-17 15:37:07.633314"], ["id", 74]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 73], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 47], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 47]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------
ExecutorTest: test_on_exception:_:pause!_pauses_workflow_on_error
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.636157"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.636157"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.636883"], ["current_step_name", nil], ["hero_id", 64], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.636883"]]
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 48], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 48], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 48], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.639050"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.637403"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:37:07.639050"], ["workflow_id", 48]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:37:07.639670"], ["id", 48]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7a02afda-8ce3-49f8-924c-e7aa0a470bc9) to Test(default) with arguments: 75
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7a02afda-8ce3-49f8-924c-e7aa0a470bc9"], ["updated_at", "2025-12-17 15:37:07.640303"], ["id", 75]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 48], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 75], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.641939"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.642038"], ["id", 75]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 48], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.643427"], ["id", 48]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 64], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 48], ["LIMIT", 1]]
Step execution 75 failed: pause error
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 75], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.5ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "error_backtrace" = $1, "error_message" = $2, "failed_at" = $3, "outcome" = $4, "state" = $5, "updated_at" = $6 WHERE "geneva_drive_step_executions"."id" = $7[0m  [["error_backtrace", "/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:108:in 'block in <class:ExceptionTestWorkflow>'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'BasicObject#instance_exec'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'GenevaDrive::StepDefinition#execute_in_context'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:68:in 'block in GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'Kernel#catch'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:299:in 'block in <class:ExecutorTest>'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:95:in 'block (2 levels) in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:191:in 'Minitest::Test#capture_exceptions'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:90:in 'block in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:382:in 'Minitest::Runnable#time_it'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:89:in 'Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'block in ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/execution_wrapper.rb:104:in 'ActiveSupport::ExecutionWrapper.perform'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:1223:in 'Minitest.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:462:in 'Minitest::Runnable.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:449:in 'block (2 levels) in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'Array#each'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'block in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:487:in 'Minitest::Runnable.on_signal'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:474:in 'Minitest::Runnable.with_info_handler'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:444:in 'Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/railties-8.1.1/lib/rails/test_unit/line_filtering.rb:10:in 'Rails::LineFiltering#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'block in Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Array#map'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:301:in 'Minitest.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:85:in 'block in Minitest.autorun'"], ["error_message", "pause error"], ["failed_at", "2025-12-17 15:37:07.645362"], ["outcome", "failed"], ["state", "failed"], ["updated_at", "2025-12-17 15:37:07.645493"], ["id", 75]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 48], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:37:07.646888"], ["updated_at", "2025-12-17 15:37:07.646983"], ["id", 48]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 75], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 48], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_cancel!_flow_control_cancels_workflow
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.648808"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.648808"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.649520"], ["current_step_name", nil], ["hero_id", 65], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.649520"]]
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 49], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 49], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 49], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.651594"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.650020"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.651594"], ["workflow_id", 49]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.652176"], ["id", 49]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 1648b387-f4bc-4d59-a382-80f9b7944500) to Test(default) with arguments: 76
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "1648b387-f4bc-4d59-a382-80f9b7944500"], ["updated_at", "2025-12-17 15:37:07.652665"], ["id", 76]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 49], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 76], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.653956"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.654059"], ["id", 76]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 49], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.655218"], ["id", 49]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 65], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 49], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 76], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.656820"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.656937"], ["id", 76]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 49], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:37:07.658008"], ["updated_at", "2025-12-17 15:37:07.658089"], ["id", 49]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 76], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 49], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
ExecutorTest: test_proceeds_without_hero_if_may_proceed_without_hero!_is_set
----------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.659875"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.659875"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.661704"], ["current_step_name", nil], ["hero_id", 66], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HeroOptionalWorkflow"], ["updated_at", "2025-12-17 15:37:07.661704"]]
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 50], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 50], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 50], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.663906"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.662227"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.663906"], ["workflow_id", 50]]
  [1m[36mHeroOptionalWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.664518"], ["id", 50]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: d73b7e1b-4f6b-4308-874c-3a0730df4d58) to Test(default) with arguments: 77
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "d73b7e1b-4f6b-4308-874c-3a0730df4d58"], ["updated_at", "2025-12-17 15:37:07.665125"], ["id", 77]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 50], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 66]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 50], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 77], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.667485"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.667591"], ["id", 77]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 50], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.668896"], ["id", 50]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 50], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 77], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:37:07.670488"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:37:07.670636"], ["id", 77]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 50], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:37:07.671947"], ["id", 50]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 50], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:37:07.673063"], ["updated_at", "2025-12-17 15:37:07.673142"], ["id", 50]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 77], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 50], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_pause!_flow_control_pauses_workflow
------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.674999"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.674999"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.675757"], ["current_step_name", nil], ["hero_id", 67], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.675757"]]
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 51], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 51], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 51], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.678139"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.676308"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.678139"], ["workflow_id", 51]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.678882"], ["id", 51]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 41ecf70b-bbc2-4a8a-92b8-06996459f88e) to Test(default) with arguments: 78
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "41ecf70b-bbc2-4a8a-92b8-06996459f88e"], ["updated_at", "2025-12-17 15:37:07.679476"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 51], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.681067"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.681180"], ["id", 78]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 51], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.682176"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.681604"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_step"], ["updated_at", "2025-12-17 15:37:07.682176"], ["workflow_id", 51]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_step"], ["updated_at", "2025-12-17 15:37:07.682990"], ["id", 51]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.683934"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.684057"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 51], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.685008"], ["id", 51]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 67], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 51], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.686746"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.686850"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 51], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:37:07.688069"], ["updated_at", "2025-12-17 15:37:07.688148"], ["id", 51]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 51], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
ExecutorTest: test_on_exception:_:cancel!_cancels_workflow_on_error
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.689955"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.689955"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.690692"], ["current_step_name", nil], ["hero_id", 68], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.690692"]]
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 52], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 52], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 52], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.693022"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.691291"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:37:07.693022"], ["workflow_id", 52]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:37:07.693670"], ["id", 52]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 24878778-c6cf-4ffa-8e65-5ca9c4de998c) to Test(default) with arguments: 80
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "24878778-c6cf-4ffa-8e65-5ca9c4de998c"], ["updated_at", "2025-12-17 15:37:07.694228"], ["id", 80]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 52], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.5ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 80], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.695894"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.696026"], ["id", 80]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 52], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.697220"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.696696"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:37:07.697220"], ["workflow_id", 52]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_error"], ["updated_at", "2025-12-17 15:37:07.697989"], ["id", 52]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.698958"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.699102"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 52], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.700135"], ["id", 52]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 52], ["LIMIT", 1]]
Step execution 81 failed: cancel error
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "error_backtrace" = $1, "error_message" = $2, "failed_at" = $3, "outcome" = $4, "state" = $5, "updated_at" = $6 WHERE "geneva_drive_step_executions"."id" = $7[0m  [["error_backtrace", "/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:120:in 'block in <class:ExceptionTestWorkflow>'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'BasicObject#instance_exec'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'GenevaDrive::StepDefinition#execute_in_context'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:68:in 'block in GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'Kernel#catch'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:341:in 'block in <class:ExecutorTest>'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:95:in 'block (2 levels) in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:191:in 'Minitest::Test#capture_exceptions'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:90:in 'block in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:382:in 'Minitest::Runnable#time_it'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:89:in 'Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'block in ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/execution_wrapper.rb:104:in 'ActiveSupport::ExecutionWrapper.perform'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:1223:in 'Minitest.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:462:in 'Minitest::Runnable.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:449:in 'block (2 levels) in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'Array#each'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'block in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:487:in 'Minitest::Runnable.on_signal'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:474:in 'Minitest::Runnable.with_info_handler'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:444:in 'Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/railties-8.1.1/lib/rails/test_unit/line_filtering.rb:10:in 'Rails::LineFiltering#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'block in Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Array#map'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:301:in 'Minitest.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:85:in 'block in Minitest.autorun'"], ["error_message", "cancel error"], ["failed_at", "2025-12-17 15:37:07.701694"], ["outcome", "canceled"], ["state", "failed"], ["updated_at", "2025-12-17 15:37:07.701814"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 52], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:37:07.703227"], ["updated_at", "2025-12-17 15:37:07.703311"], ["id", 52]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 52], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------
ExecutorTest: test_step_execution_idempotency_-_does_not_re-execute_completed_step
----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.705354"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.705354"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.707374"], ["current_step_name", nil], ["hero_id", 69], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.707374"]]
  [1m[36mExecutorTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 53], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 53], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 53], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.709755"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.707979"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:37:07.709755"], ["workflow_id", 53]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:37:07.710440"], ["id", 53]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: cd31fe5a-3e4f-4554-87a9-8f029a16634b) to Test(default) with arguments: 82
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "cd31fe5a-3e4f-4554-87a9-8f029a16634b"], ["updated_at", "2025-12-17 15:37:07.711081"], ["id", 82]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 53], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.712681"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.712782"], ["id", 82]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 53], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.714077"], ["id", 53]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 69], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 53], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:37:07.715851"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:37:07.715954"], ["id", 82]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 53], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:37:07.716846"], ["id", 53]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 53], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 53], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 53], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.718966"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.717225"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:37:07.718966"], ["workflow_id", 53]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:37:07.719661"], ["id", 53]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: b4fd7ba7-dcfa-4cef-ac82-86b4363681e6) to Test(default) with arguments: 83
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "b4fd7ba7-dcfa-4cef-ac82-86b4363681e6"], ["updated_at", "2025-12-17 15:37:07.720202"], ["id", 83]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 53], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_cancels_workflow_if_hero_is_deleted
------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.722516"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.722516"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.724445"], ["current_step_name", nil], ["hero_id", 70], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "NoHeroTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.724445"]]
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 54], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 54], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 54], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.726713"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.724937"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.726713"], ["workflow_id", 54]]
  [1m[36mNoHeroTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.727349"], ["id", 54]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 08cdaae0-62a4-4a76-8cf2-74fec59b7757) to Test(default) with arguments: 84
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "08cdaae0-62a4-4a76-8cf2-74fec59b7757"], ["updated_at", "2025-12-17 15:37:07.727848"], ["id", 84]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 54], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 70]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 54], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 84], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.730179"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.730289"], ["id", 84]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 54], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.731553"], ["id", 54]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 70], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 84], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.732983"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.733115"], ["id", 84]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 54], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:37:07.734271"], ["updated_at", "2025-12-17 15:37:07.734353"], ["id", 54]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 84], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 54], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_executes_step_and_transitions_to_next
--------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.735945"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.735945"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.736489"], ["current_step_name", nil], ["hero_id", 71], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.736489"]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 55], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.738364"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.736904"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:37:07.738364"], ["workflow_id", 55]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:37:07.738901"], ["id", 55]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 2280b12b-0f5a-4abc-ad76-90a55f17f650) to Test(default) with arguments: 85
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "2280b12b-0f5a-4abc-ad76-90a55f17f650"], ["updated_at", "2025-12-17 15:37:07.739335"], ["id", 85]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 55], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 85], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.740479"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.740582"], ["id", 85]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 55], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.741727"], ["id", 55]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 71], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 85], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:37:07.743487"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:37:07.743609"], ["id", 85]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 55], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:37:07.744873"], ["id", 55]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 55], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.747203"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.745438"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:37:07.747203"], ["workflow_id", 55]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:37:07.747860"], ["id", 55]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7fd92036-d1fd-4910-9bbf-60ed70b5b7a7) to Test(default) with arguments: 86
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7fd92036-d1fd-4910-9bbf-60ed70b5b7a7"], ["updated_at", "2025-12-17 15:37:07.748446"], ["id", 86]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 85], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 55], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 55]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
ExecutorTest: test_finished!_flow_control_finishes_workflow_immediately
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.750862"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.750862"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.751598"], ["current_step_name", nil], ["hero_id", 72], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:37:07.751598"]]
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 56], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 56], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 56], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.753917"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.752146"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.753917"], ["workflow_id", 56]]
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:37:07.754647"], ["id", 56]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 87f43486-8e38-42e6-8e15-abff2d393816) to Test(default) with arguments: 87
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "87f43486-8e38-42e6-8e15-abff2d393816"], ["updated_at", "2025-12-17 15:37:07.755233"], ["id", 87]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 56], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 87], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.756775"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.756879"], ["id", 87]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 56], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.758051"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.757472"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "finish_step"], ["updated_at", "2025-12-17 15:37:07.758051"], ["workflow_id", 56]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "finish_step"], ["updated_at", "2025-12-17 15:37:07.758847"], ["id", 56]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 88], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:37:07.760098"], ["state", "executing"], ["updated_at", "2025-12-17 15:37:07.760209"], ["id", 88]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 56], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:37:07.761505"], ["id", 56]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 72], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 56], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 88], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:37:07.762820"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:37:07.762943"], ["id", 88]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 56], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:37:07.763826"], ["updated_at", "2025-12-17 15:37:07.763902"], ["id", 56]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 88], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 56], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_cancel_if_conditions_are_inherited
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.765690"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.765690"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_job_options_are_merged_from_parent
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.766745"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.766745"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
WorkflowTest: test_step_definitions_are_inherited
-------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.767686"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.767686"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
WorkflowTest: test_transitioned_at_is_set_when_transitioning_to_terminal_states
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.768550"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.768550"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.770469"], ["current_step_name", nil], ["hero_id", 76], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:37:07.770469"]]
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 57], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 57], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 57], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.772580"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.770970"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.772580"], ["workflow_id", 57]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.773306"], ["id", 57]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 09cf8ac2-014a-439e-a06d-71901700cbfc) to Test(default) with arguments: 89
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "09cf8ac2-014a-439e-a06d-71901700cbfc"], ["updated_at", "2025-12-17 15:37:07.773953"], ["id", 89]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 57], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:37:07.775220"], ["updated_at", "2025-12-17 15:37:07.775321"], ["id", 57]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
WorkflowTest: test_creates_workflow_with_hero_and_schedules_first_step
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.776603"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.776603"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.777290"], ["current_step_name", nil], ["hero_id", 77], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:37:07.777290"]]
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 58], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 58], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 58], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.779665"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.777856"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.779665"], ["workflow_id", 58]]
  [1m[36mSimpleWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.780317"], ["id", 58]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3fcfbc81-5bbf-49ed-ab5d-29e40a80606f) to Test(default) with arguments: 90
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3fcfbc81-5bbf-49ed-ab5d-29e40a80606f"], ["updated_at", "2025-12-17 15:37:07.780924"], ["id", 90]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 58]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 58], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_step_collection_provides_ordered_steps
---------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.782947"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.782947"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
WorkflowTest: test_step_collection_finds_next_step
--------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.784106"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.784106"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
WorkflowTest: test_scopes_work_correctly
----------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.785267"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.785267"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.785948"], ["current_step_name", nil], ["hero_id", 80], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:37:07.785948"]]
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 59], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 59], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 59], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.788261"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.786525"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.788261"], ["workflow_id", 59]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.788903"], ["id", 59]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 333dd788-040f-4f43-9abc-daa75d8e8426) to Test(default) with arguments: 91
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "333dd788-040f-4f43-9abc-daa75d8e8426"], ["updated_at", "2025-12-17 15:37:07.789443"], ["id", 91]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", true], ["created_at", "2025-12-17 15:37:07.790088"], ["current_step_name", nil], ["hero_id", 80], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:37:07.790088"]]
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 60], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 60], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 60], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.792367"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.790630"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.792367"], ["workflow_id", 60]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.793019"], ["id", 60]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: a0538701-efbb-42a8-96e2-d685523bee85) to Test(default) with arguments: 92
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "a0538701-efbb-42a8-96e2-d685523bee85"], ["updated_at", "2025-12-17 15:37:07.793588"], ["id", 92]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 60], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:37:07.794755"], ["updated_at", "2025-12-17 15:37:07.794838"], ["id", 60]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "ready"], ["id", 59], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "finished"], ["id", 60], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 59], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 60], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."hero_type" = $1 AND "geneva_drive_workflows"."hero_id" = $2[0m  [["hero_type", "User"], ["hero_id", 80]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
WorkflowTest: test_workflow_with_wait_schedules_step_for_future
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.798352"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.798352"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.800352"], ["current_step_name", nil], ["hero_id", 81], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "WaitingWorkflow"], ["updated_at", "2025-12-17 15:37:07.800352"]]
  [1m[36mWaitingWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 61], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 61], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 61], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.802700"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.800942"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "immediate_step"], ["updated_at", "2025-12-17 15:37:07.802700"], ["workflow_id", 61]]
  [1m[36mWaitingWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "immediate_step"], ["updated_at", "2025-12-17 15:37:07.803368"], ["id", 61]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: dbd176cf-23a9-463d-843f-ca5b74101d8d) to Test(default) with arguments: 93
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "dbd176cf-23a9-463d-843f-ca5b74101d8d"], ["updated_at", "2025-12-17 15:37:07.803887"], ["id", 93]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 61], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 93], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:37:07.805489"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:37:07.805590"], ["id", 93]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 61], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 61], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 61], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 61], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.808674"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-19 15:37:07.806978"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "delayed_step"], ["updated_at", "2025-12-17 15:37:07.808674"], ["workflow_id", 61]]
  [1m[36mWaitingWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "delayed_step"], ["updated_at", "2025-12-17 15:37:07.809315"], ["id", 61]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: ab4006a1-9ab1-47da-b067-a200e7c28b42) to Test(default) at 2025-12-19 15:37:07 UTC with arguments: 94
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "ab4006a1-9ab1-47da-b067-a200e7c28b42"], ["updated_at", "2025-12-17 15:37:07.809892"], ["id", 94]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" DESC LIMIT $2[0m  [["workflow_id", 61], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_may_proceed_without_hero!_is_inherited
---------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.811990"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.811990"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
WorkflowTest: test_resume!_raises_for_non-paused_workflows
----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.813294"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.813294"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.813975"], ["current_step_name", nil], ["hero_id", 83], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:37:07.813975"]]
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 62], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 62], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 62], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.816370"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.814555"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.816370"], ["workflow_id", 62]]
  [1m[36mSimpleWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.816996"], ["id", 62]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 35799e1a-1b68-44d9-afed-d532dda25c59) to Test(default) with arguments: 95
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "35799e1a-1b68-44d9-afed-d532dda25c59"], ["updated_at", "2025-12-17 15:37:07.817613"], ["id", 95]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_resume!_works_for_paused_workflows
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:37:07.818796"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:37:07.818796"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:37:07.819483"], ["current_step_name", nil], ["hero_id", 84], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:37:07.819483"]]
  [1m[36mSimpleWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 63], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 63], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 63], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.821795"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.820033"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.821795"], ["workflow_id", 63]]
  [1m[36mSimpleWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.822496"], ["id", 63]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 9b24c2f6-b9c7-4ad8-9c7a-008dfff48183) to Test(default) with arguments: 96
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "9b24c2f6-b9c7-4ad8-9c7a-008dfff48183"], ["updated_at", "2025-12-17 15:37:07.823110"], ["id", 96]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 63], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:37:07.824110"], ["updated_at", "2025-12-17 15:37:07.824192"], ["id", 63]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 63], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "ready"], ["transitioned_at", nil], ["updated_at", "2025-12-17 15:37:07.825084"], ["id", 63]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 63], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 63], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 96], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:37:07.826840"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:37:07.826951"], ["id", 96]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 63], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:37:07.827775"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:37:07.825503"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:37:07.827775"], ["workflow_id", 63]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 00761bd8-63e0-4c7d-bf0b-774c9d22ce51) to Test(default) with arguments: 97
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "00761bd8-63e0-4c7d-bf0b-774c9d22ce51"], ["updated_at", "2025-12-17 15:37:07.828581"], ["id", 97]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 63]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
GenevaDriveTest: test_it_has_a_version_number
---------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[36mActiveRecord::InternalMetadata Load (1.7ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_executes_step_and_transitions_to_next
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.495640"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.495640"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (1.0ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.504532"], ["current_step_name", nil], ["hero_id", 85], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.504532"]]
  [1m[36mExecutorTestWorkflow Load (1.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 64], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (2.6ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 64], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 64], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (1.0ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.522505"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.505778"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:39:22.522505"], ["workflow_id", 64]]
  [1m[36mExecutorTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:39:22.523814"], ["id", 64]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 1d8fdfc0-d214-4f38-894b-8a5a3de21630) to Test(default) with arguments: 98
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "1d8fdfc0-d214-4f38-894b-8a5a3de21630"], ["updated_at", "2025-12-17 15:39:22.541698"], ["id", 98]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 64], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 98], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.544146"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.544243"], ["id", 98]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 64], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.545621"], ["id", 64]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 85], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 64], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 98], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.548649"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.548743"], ["id", 98]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 64], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.550120"], ["id", 64]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 64], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 64], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 64], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.552417"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.550680"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:39:22.552417"], ["workflow_id", 64]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:39:22.553079"], ["id", 64]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: d54aaf81-63db-4eb3-819d-cd6f32b0e849) to Test(default) with arguments: 99
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "d54aaf81-63db-4eb3-819d-cd6f32b0e849"], ["updated_at", "2025-12-17 15:39:22.553762"], ["id", 99]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 98], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 64], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 64]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
ExecutorTest: test_proceeds_without_hero_if_may_proceed_without_hero!_is_set
----------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.557611"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.557611"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.559528"], ["current_step_name", nil], ["hero_id", 86], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HeroOptionalWorkflow"], ["updated_at", "2025-12-17 15:39:22.559528"]]
  [1m[36mHeroOptionalWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 65], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 65], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 65], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.561729"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.560082"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.561729"], ["workflow_id", 65]]
  [1m[36mHeroOptionalWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.562470"], ["id", 65]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 252e3b39-d516-4ba1-ae7e-a331bc6e364a) to Test(default) with arguments: 100
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "252e3b39-d516-4ba1-ae7e-a331bc6e364a"], ["updated_at", "2025-12-17 15:39:22.562975"], ["id", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 65], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.3ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 86]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 65], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 100], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.565606"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.565816"], ["id", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 65], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.567198"], ["id", 65]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 65], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 100], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.568770"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.568881"], ["id", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 65], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.570077"], ["id", 65]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 65], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.571165"], ["updated_at", "2025-12-17 15:39:22.571230"], ["id", 65]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 100], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 65], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_cancel!_flow_control_cancels_workflow
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.573208"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.573208"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.575452"], ["current_step_name", nil], ["hero_id", 87], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.575452"]]
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 66], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 66], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 66], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.577851"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.576022"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.577851"], ["workflow_id", 66]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.578639"], ["id", 66]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: cb8a2ae2-14ea-44ed-996d-b255fdc91a1a) to Test(default) with arguments: 101
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "cb8a2ae2-14ea-44ed-996d-b255fdc91a1a"], ["updated_at", "2025-12-17 15:39:22.579156"], ["id", 101]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 66], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.9ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 101], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.581674"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.581779"], ["id", 101]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 66], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.583681"], ["id", 66]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 87], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 66], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.8ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 101], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.586563"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.587192"], ["id", 101]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 66], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:39:22.589444"], ["updated_at", "2025-12-17 15:39:22.589975"], ["id", 66]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 101], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 66], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
ExecutorTest: test_on_exception:_:cancel!_cancels_workflow_on_error
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.593060"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.593060"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.4ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.599659"], ["current_step_name", nil], ["hero_id", 88], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.599659"]]
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 67], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 67], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 67], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.604194"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.600868"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:39:22.604194"], ["workflow_id", 67]]
  [1m[36mExceptionTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:39:22.606034"], ["id", 67]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 218d17a6-99c8-4e44-a78e-089a3b1592b1) to Test(default) with arguments: 102
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "218d17a6-99c8-4e44-a78e-089a3b1592b1"], ["updated_at", "2025-12-17 15:39:22.606898"], ["id", 102]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 67], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 102], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.608861"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.609469"], ["id", 102]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 67], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.610582"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.610063"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:39:22.610582"], ["workflow_id", 67]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_error"], ["updated_at", "2025-12-17 15:39:22.611266"], ["id", 67]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 103], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.612426"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.612520"], ["id", 103]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 67], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.613702"], ["id", 67]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 88], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 67], ["LIMIT", 1]]
Step execution 103 failed: cancel error
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 103], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.6ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "error_backtrace" = $1, "error_message" = $2, "failed_at" = $3, "outcome" = $4, "state" = $5, "updated_at" = $6 WHERE "geneva_drive_step_executions"."id" = $7[0m  [["error_backtrace", "/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:120:in 'block in <class:ExceptionTestWorkflow>'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'BasicObject#instance_exec'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'GenevaDrive::StepDefinition#execute_in_context'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:68:in 'block in GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'Kernel#catch'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:341:in 'block in <class:ExecutorTest>'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:95:in 'block (2 levels) in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:191:in 'Minitest::Test#capture_exceptions'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:90:in 'block in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:382:in 'Minitest::Runnable#time_it'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:89:in 'Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'block in ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/execution_wrapper.rb:104:in 'ActiveSupport::ExecutionWrapper.perform'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:1223:in 'Minitest.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:462:in 'Minitest::Runnable.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:449:in 'block (2 levels) in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'Array#each'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'block in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:487:in 'Minitest::Runnable.on_signal'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:474:in 'Minitest::Runnable.with_info_handler'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:444:in 'Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/railties-8.1.1/lib/rails/test_unit/line_filtering.rb:10:in 'Rails::LineFiltering#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'block in Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Array#map'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:301:in 'Minitest.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:85:in 'block in Minitest.autorun'"], ["error_message", "cancel error"], ["failed_at", "2025-12-17 15:39:22.615764"], ["outcome", "canceled"], ["state", "failed"], ["updated_at", "2025-12-17 15:39:22.615859"], ["id", 103]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 67], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:39:22.617294"], ["updated_at", "2025-12-17 15:39:22.617370"], ["id", 67]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 103], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 67], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_skip!_flow_control_skips_to_next_step
--------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.619343"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.619343"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.620019"], ["current_step_name", nil], ["hero_id", 89], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.620019"]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 68], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.622112"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.620549"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.622112"], ["workflow_id", 68]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.622636"], ["id", 68]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c0c3ea67-a5ce-465e-80b6-ad93e8e1a511) to Test(default) with arguments: 104
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c0c3ea67-a5ce-465e-80b6-ad93e8e1a511"], ["updated_at", "2025-12-17 15:39:22.623081"], ["id", 104]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 68], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 104], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.624464"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.624570"], ["id", 104]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.625430"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.625032"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_step"], ["updated_at", "2025-12-17 15:39:22.625430"], ["workflow_id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skip_step"], ["updated_at", "2025-12-17 15:39:22.625986"], ["id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.626829"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.626927"], ["id", 105]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 68], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.627828"], ["id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 89], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 68], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:39:22.629276"], ["state", "skipped"], ["updated_at", "2025-12-17 15:39:22.629360"], ["id", 105]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 68], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.630267"], ["id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 68], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.631883"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.630654"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "reattempt_step"], ["updated_at", "2025-12-17 15:39:22.631883"], ["workflow_id", 68]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "reattempt_step"], ["updated_at", "2025-12-17 15:39:22.632392"], ["id", 68]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 275d2dbe-0c12-40e5-8443-1018942c0af8) to Test(default) with arguments: 106
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "275d2dbe-0c12-40e5-8443-1018942c0af8"], ["updated_at", "2025-12-17 15:39:22.632766"], ["id", 106]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 68], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 68]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------
ExecutorTest: test_step_execution_idempotency_-_does_not_re-execute_completed_step
----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.634428"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.634428"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.634912"], ["current_step_name", nil], ["hero_id", 90], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.634912"]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 69], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 69], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 69], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.636511"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.635299"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:39:22.636511"], ["workflow_id", 69]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:39:22.636925"], ["id", 69]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: cf579a12-5c00-4e41-80c2-186121e2ea3b) to Test(default) with arguments: 107
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "cf579a12-5c00-4e41-80c2-186121e2ea3b"], ["updated_at", "2025-12-17 15:39:22.637292"], ["id", 107]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 69], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.638424"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.638566"], ["id", 107]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 69], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.639544"], ["id", 69]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 90], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 69], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.640960"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.641168"], ["id", 107]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 69], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.642053"], ["id", 69]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 69], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 69], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 69], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.643597"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.642440"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:39:22.643597"], ["workflow_id", 69]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:39:22.644016"], ["id", 69]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 18f2485c-ee52-4ff3-a46c-e640b4843c99) to Test(default) with arguments: 108
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "18f2485c-ee52-4ff3-a46c-e640b4843c99"], ["updated_at", "2025-12-17 15:39:22.644405"], ["id", 108]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 69], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
ExecutorTest: test_on_exception:_:skip!_skips_step_on_error
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.646261"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.646261"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.646764"], ["current_step_name", nil], ["hero_id", 91], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.646764"]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 70], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 70], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 70], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.648236"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.647148"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:39:22.648236"], ["workflow_id", 70]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:39:22.648659"], ["id", 70]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 041109bb-6369-4534-912a-ca1e40668d8d) to Test(default) with arguments: 109
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "041109bb-6369-4534-912a-ca1e40668d8d"], ["updated_at", "2025-12-17 15:39:22.649044"], ["id", 109]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 70], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.650022"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.650111"], ["id", 109]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 70], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.650946"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.650533"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_error"], ["updated_at", "2025-12-17 15:39:22.650946"], ["workflow_id", 70]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skip_error"], ["updated_at", "2025-12-17 15:39:22.651418"], ["id", 70]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.652218"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.652306"], ["id", 110]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 70], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.653142"], ["id", 70]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 91], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 70], ["LIMIT", 1]]
Step execution 110 failed: skip error
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:39:22.654402"], ["state", "skipped"], ["updated_at", "2025-12-17 15:39:22.654485"], ["id", 110]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 70], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.655325"], ["id", 70]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 70], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 70], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 70], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.656831"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.655693"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:39:22.656831"], ["workflow_id", 70]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_error"], ["updated_at", "2025-12-17 15:39:22.657245"], ["id", 70]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 9c1862d6-11f4-4d82-8972-d39ef32af46c) to Test(default) with arguments: 111
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "9c1862d6-11f4-4d82-8972-d39ef32af46c"], ["updated_at", "2025-12-17 15:39:22.657666"], ["id", 111]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 70], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
ExecutorTest: test_cancel_if_condition_cancels_workflow
-------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.658936"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.658936"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.659380"], ["email", "[FILTERED]"], ["name", "Cancel"], ["updated_at", "2025-12-17 15:39:22.659380"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.661234"], ["current_step_name", nil], ["hero_id", 93], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "CancelIfTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.661234"]]
  [1m[36mCancelIfTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 71], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 71], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 71], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.662879"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.661640"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first"], ["updated_at", "2025-12-17 15:39:22.662879"], ["workflow_id", 71]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first"], ["updated_at", "2025-12-17 15:39:22.663331"], ["id", 71]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4310d58e-9347-44d0-8659-80efc2897f43) to Test(default) with arguments: 112
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4310d58e-9347-44d0-8659-80efc2897f43"], ["updated_at", "2025-12-17 15:39:22.663714"], ["id", 112]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 71], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 112], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.664767"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.664850"], ["id", 112]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 71], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.665712"], ["id", 71]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 93], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 112], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.666702"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.666797"], ["id", 112]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 71], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:39:22.667566"], ["updated_at", "2025-12-17 15:39:22.667633"], ["id", 71]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 112], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "CancelIfTestWorkflow"], ["id", 71], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
ExecutorTest: test_finished!_flow_control_finishes_workflow_immediately
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.668954"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.668954"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.669435"], ["current_step_name", nil], ["hero_id", 94], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.669435"]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 72], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 72], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 72], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.670868"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.669794"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.670868"], ["workflow_id", 72]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.671258"], ["id", 72]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: af86d25d-a93e-40c8-8abe-d366630c3b9d) to Test(default) with arguments: 113
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "af86d25d-a93e-40c8-8abe-d366630c3b9d"], ["updated_at", "2025-12-17 15:39:22.671621"], ["id", 113]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 72], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 113], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.672686"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.672798"], ["id", 113]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 72], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.673674"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.673227"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "finish_step"], ["updated_at", "2025-12-17 15:39:22.673674"], ["workflow_id", 72]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "finish_step"], ["updated_at", "2025-12-17 15:39:22.674179"], ["id", 72]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 114], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.675068"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.675163"], ["id", 114]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 72], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.676007"], ["id", 72]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 94], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 72], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 114], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.677249"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.677349"], ["id", 114]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 72], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.678204"], ["updated_at", "2025-12-17 15:39:22.678268"], ["id", 72]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 114], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 72], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------
ExecutorTest: test_on_exception:_:pause!_pauses_workflow_on_error
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.679569"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.679569"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.680101"], ["current_step_name", nil], ["hero_id", 95], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.680101"]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 73], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 73], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 73], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.681571"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.680468"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:39:22.681571"], ["workflow_id", 73]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:39:22.681993"], ["id", 73]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: f5a7bf63-9a3a-43f0-9e14-3e1c23664ea1) to Test(default) with arguments: 115
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "f5a7bf63-9a3a-43f0-9e14-3e1c23664ea1"], ["updated_at", "2025-12-17 15:39:22.682379"], ["id", 115]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 73], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 115], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.683343"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.683427"], ["id", 115]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 73], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.684258"], ["id", 73]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 95], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 73], ["LIMIT", 1]]
Step execution 115 failed: pause error
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 115], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "error_backtrace" = $1, "error_message" = $2, "failed_at" = $3, "outcome" = $4, "state" = $5, "updated_at" = $6 WHERE "geneva_drive_step_executions"."id" = $7[0m  [["error_backtrace", "/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:108:in 'block in <class:ExceptionTestWorkflow>'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'BasicObject#instance_exec'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'GenevaDrive::StepDefinition#execute_in_context'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:68:in 'block in GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'Kernel#catch'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:299:in 'block in <class:ExecutorTest>'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:95:in 'block (2 levels) in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:191:in 'Minitest::Test#capture_exceptions'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:90:in 'block in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:382:in 'Minitest::Runnable#time_it'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:89:in 'Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'block in ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/execution_wrapper.rb:104:in 'ActiveSupport::ExecutionWrapper.perform'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:1223:in 'Minitest.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:462:in 'Minitest::Runnable.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:449:in 'block (2 levels) in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'Array#each'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'block in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:487:in 'Minitest::Runnable.on_signal'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:474:in 'Minitest::Runnable.with_info_handler'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:444:in 'Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/railties-8.1.1/lib/rails/test_unit/line_filtering.rb:10:in 'Rails::LineFiltering#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'block in Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Array#map'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:301:in 'Minitest.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:85:in 'block in Minitest.autorun'"], ["error_message", "pause error"], ["failed_at", "2025-12-17 15:39:22.685465"], ["outcome", "failed"], ["state", "failed"], ["updated_at", "2025-12-17 15:39:22.685557"], ["id", 115]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 73], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:39:22.686345"], ["updated_at", "2025-12-17 15:39:22.686407"], ["id", 73]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 115], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 73], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_cancels_workflow_if_hero_is_deleted
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.687612"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.687612"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.689378"], ["current_step_name", nil], ["hero_id", 96], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "NoHeroTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.689378"]]
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 74], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 74], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 74], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.691142"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.689806"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.691142"], ["workflow_id", 74]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.691611"], ["id", 74]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 1d2c1839-9281-4551-a815-ec25fe2abca7) to Test(default) with arguments: 116
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "1d2c1839-9281-4551-a815-ec25fe2abca7"], ["updated_at", "2025-12-17 15:39:22.692043"], ["id", 116]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 74], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 96]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 74], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 116], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.693744"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.693837"], ["id", 116]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 74], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.694709"], ["id", 74]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 96], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 116], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.695647"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.695738"], ["id", 116]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 74], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:39:22.696526"], ["updated_at", "2025-12-17 15:39:22.696599"], ["id", 74]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 116], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 74], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
ExecutorTest: test_skip_if_condition_evaluated_at_execution_time
----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.697897"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.697897"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.698327"], ["email", "[FILTERED]"], ["name", "Skip"], ["updated_at", "2025-12-17 15:39:22.698327"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.699941"], ["current_step_name", nil], ["hero_id", 98], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SkipIfTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.699941"]]
  [1m[36mSkipIfTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 75], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 75], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 75], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.701608"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.700354"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skippable"], ["updated_at", "2025-12-17 15:39:22.701608"], ["workflow_id", 75]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skippable"], ["updated_at", "2025-12-17 15:39:22.702060"], ["id", 75]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 22eead2b-79ed-4a33-9beb-42bf63dd3b12) to Test(default) with arguments: 117
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "22eead2b-79ed-4a33-9beb-42bf63dd3b12"], ["updated_at", "2025-12-17 15:39:22.702448"], ["id", 117]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 75], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 117], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.703513"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.703617"], ["id", 117]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 75], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.704481"], ["id", 75]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 98], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 75], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 117], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:39:22.705688"], ["state", "skipped"], ["updated_at", "2025-12-17 15:39:22.705786"], ["id", 117]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 75], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.706662"], ["id", 75]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 75], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 75], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 75], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.708082"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.707005"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "final"], ["updated_at", "2025-12-17 15:39:22.708082"], ["workflow_id", 75]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "final"], ["updated_at", "2025-12-17 15:39:22.708500"], ["id", 75]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 73f69dc2-d835-413d-93b2-5b293ae26751) to Test(default) with arguments: 118
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "73f69dc2-d835-413d-93b2-5b293ae26751"], ["updated_at", "2025-12-17 15:39:22.708852"], ["id", 118]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 117], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkipIfTestWorkflow"], ["id", 75], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ExecutorTest: test_calls_before_step_starts_hook
------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.710114"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.710114"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.711872"], ["current_step_name", nil], ["hero_id", 99], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HookTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.711872"]]
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 76], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 76], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 76], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.713633"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.712356"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "tracked_step"], ["updated_at", "2025-12-17 15:39:22.713633"], ["workflow_id", 76]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "tracked_step"], ["updated_at", "2025-12-17 15:39:22.714077"], ["id", 76]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 941afa45-16bb-48b6-8b5c-76c0f489f73c) to Test(default) with arguments: 119
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "941afa45-16bb-48b6-8b5c-76c0f489f73c"], ["updated_at", "2025-12-17 15:39:22.714481"], ["id", 119]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 76], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 119], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.715533"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.715619"], ["id", 119]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 76], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.716457"], ["id", 76]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 99], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 76], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 119], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.717718"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.717814"], ["id", 119]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 76], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.718676"], ["id", 76]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 76], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.719415"], ["updated_at", "2025-12-17 15:39:22.719478"], ["id", 76]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_pause!_flow_control_pauses_workflow
------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.720326"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.720326"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.720818"], ["current_step_name", nil], ["hero_id", 100], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:39:22.720818"]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 77], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 77], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 77], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.722292"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.721196"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.722292"], ["workflow_id", 77]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:39:22.722713"], ["id", 77]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 577b0d0b-17fa-4b5a-b25c-59c180c348c4) to Test(default) with arguments: 120
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "577b0d0b-17fa-4b5a-b25c-59c180c348c4"], ["updated_at", "2025-12-17 15:39:22.723087"], ["id", 120]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 77], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 120], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.724094"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.724175"], ["id", 120]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 77], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.724954"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.724568"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_step"], ["updated_at", "2025-12-17 15:39:22.724954"], ["workflow_id", 77]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_step"], ["updated_at", "2025-12-17 15:39:22.725465"], ["id", 77]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 121], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.726239"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.726329"], ["id", 121]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 77], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.727164"], ["id", 77]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 100], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 77], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 121], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.728330"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.728411"], ["id", 121]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 77], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:39:22.729218"], ["updated_at", "2025-12-17 15:39:22.729288"], ["id", 77]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 121], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 77], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------
TestHelpersTest: test_assert_workflow_state_checks_workflow_state
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.730750"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.730750"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.732448"], ["current_step_name", nil], ["hero_id", 101], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:39:22.732448"]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 78], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.734069"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.732844"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.734069"], ["workflow_id", 78]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.734466"], ["id", 78]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 03a0e63d-0a29-4a3b-9631-1c72dd43a693) to Test(default) with arguments: 122
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "03a0e63d-0a29-4a3b-9631-1c72dd43a693"], ["updated_at", "2025-12-17 15:39:22.734856"], ["id", 122]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 78], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 122], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.736970"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.737068"], ["id", 122]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.737910"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 101], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 122], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.739116"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.739222"], ["id", 122]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.740036"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 78], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.741523"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.740379"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.741523"], ["workflow_id", 78]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.741953"], ["id", 78]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 720b38b3-de70-4685-9913-54eb34f7721a) to Test(default) with arguments: 123
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "720b38b3-de70-4685-9913-54eb34f7721a"], ["updated_at", "2025-12-17 15:39:22.742294"], ["id", 123]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 78], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 123], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.743880"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.743973"], ["id", 123]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.744819"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 101], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 123], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.746020"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.746113"], ["id", 123]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.746946"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 78], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.748474"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.747338"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.748474"], ["workflow_id", 78]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.748887"], ["id", 78]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 2339975c-944d-49fb-81ef-8eec8c54ab68) to Test(default) with arguments: 124
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "2339975c-944d-49fb-81ef-8eec8c54ab68"], ["updated_at", "2025-12-17 15:39:22.749237"], ["id", 124]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 78], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 124], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.750909"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.751005"], ["id", 124]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.751852"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 101], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 124], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.753081"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.753170"], ["id", 124]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.754014"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.754733"], ["updated_at", "2025-12-17 15:39:22.754790"], ["id", 78]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 78], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
TestHelpersTest: test_step_workflow_executes_one_step_at_a_time
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.756308"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.756308"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.756787"], ["current_step_name", nil], ["hero_id", 102], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:39:22.756787"]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 79], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.758252"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.757185"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.758252"], ["workflow_id", 79]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.758665"], ["id", 79]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: d53a4e5b-134c-4422-8388-a8fd66a374d0) to Test(default) with arguments: 125
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "d53a4e5b-134c-4422-8388-a8fd66a374d0"], ["updated_at", "2025-12-17 15:39:22.759057"], ["id", 125]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 79], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 125], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.760668"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.760749"], ["id", 125]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.761556"], ["id", 79]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 102], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 125], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.762741"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.762822"], ["id", 125]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.763640"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 79], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.765114"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.763989"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.765114"], ["workflow_id", 79]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.765527"], ["id", 79]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: ffbf5eac-f628-4b98-beb3-7444f9280f1d) to Test(default) with arguments: 126
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "ffbf5eac-f628-4b98-beb3-7444f9280f1d"], ["updated_at", "2025-12-17 15:39:22.765873"], ["id", 126]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 79], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 126], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.767607"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.767688"], ["id", 126]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.768508"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 102], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 126], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.769752"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.769855"], ["id", 126]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.770724"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 79], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.772255"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.771088"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.772255"], ["workflow_id", 79]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.772689"], ["id", 79]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: d6e79552-9f2f-4ba9-8751-edd14cef959e) to Test(default) with arguments: 127
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "d6e79552-9f2f-4ba9-8751-edd14cef959e"], ["updated_at", "2025-12-17 15:39:22.773050"], ["id", 127]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 79], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 127], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.774944"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.775054"], ["id", 127]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.775889"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 102], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 79], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 127], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.777089"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.777178"], ["id", 127]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.777996"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.778719"], ["updated_at", "2025-12-17 15:39:22.778793"], ["id", 79]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 79], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
TestHelpersTest: test_speedrun_workflow_stops_on_pause
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.779834"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.779834"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.781458"], ["current_step_name", nil], ["hero_id", 103], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "PausingWorkflow"], ["updated_at", "2025-12-17 15:39:22.781458"]]
  [1m[36mPausingWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "PausingWorkflow"], ["id", 80], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 80], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 80], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.783053"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.781880"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "will_pause"], ["updated_at", "2025-12-17 15:39:22.783053"], ["workflow_id", 80]]
  [1m[36mPausingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "will_pause"], ["updated_at", "2025-12-17 15:39:22.783463"], ["id", 80]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: dc2d4dd0-448d-43f1-8eea-cfc1bbb9e26c) to Test(default) with arguments: 128
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "dc2d4dd0-448d-43f1-8eea-cfc1bbb9e26c"], ["updated_at", "2025-12-17 15:39:22.783829"], ["id", 128]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "PausingWorkflow"], ["id", 80], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 80], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 80], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 128], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.785447"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.785528"], ["id", 128]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "PausingWorkflow"], ["id", 80], ["LIMIT", 1]]
  [1m[36mPausingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.786380"], ["id", 80]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 103], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 80], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 128], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.787657"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.787748"], ["id", 128]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "PausingWorkflow"], ["id", 80], ["LIMIT", 1]]
  [1m[36mPausingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:39:22.788491"], ["updated_at", "2025-12-17 15:39:22.788554"], ["id", 80]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "PausingWorkflow"], ["id", 80], ["LIMIT", 1]]
  [1m[36mPausingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "PausingWorkflow"], ["id", 80], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 80]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TestHelpersTest: test_speedrun_workflow_runs_workflow_to_completion
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.790131"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.790131"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.790608"], ["current_step_name", nil], ["hero_id", 104], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:39:22.790608"]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 81], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.792128"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.791004"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.792128"], ["workflow_id", 81]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.792568"], ["id", 81]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4f67d9e8-5253-4011-922b-e4cea7b92edf) to Test(default) with arguments: 129
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4f67d9e8-5253-4011-922b-e4cea7b92edf"], ["updated_at", "2025-12-17 15:39:22.798037"], ["id", 129]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 81], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 129], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.799934"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.800030"], ["id", 129]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.800874"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 104], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 129], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.802350"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.802435"], ["id", 129]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.803263"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 81], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.804801"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.803629"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.804801"], ["workflow_id", 81]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.805218"], ["id", 81]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: f7e51a94-1b90-4a1b-8bff-3ea184061e1e) to Test(default) with arguments: 130
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "f7e51a94-1b90-4a1b-8bff-3ea184061e1e"], ["updated_at", "2025-12-17 15:39:22.805588"], ["id", 130]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 81], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 130], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.807436"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.807539"], ["id", 130]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.808401"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 104], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 130], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.809615"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.809701"], ["id", 130]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.810541"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 81], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.812286"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.810912"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.812286"], ["workflow_id", 81]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.812707"], ["id", 81]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c4b34550-e288-4e07-82d3-8afbef2bd507) to Test(default) with arguments: 131
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c4b34550-e288-4e07-82d3-8afbef2bd507"], ["updated_at", "2025-12-17 15:39:22.813071"], ["id", 131]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 81], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 131], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.814629"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.814711"], ["id", 131]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.815789"], ["id", 81]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 104], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 81], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 131], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.816929"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.817012"], ["id", 131]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.817832"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.818562"], ["updated_at", "2025-12-17 15:39:22.818625"], ["id", 81]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 81], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" = $2[0m  [["workflow_id", 81], ["state", "completed"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
TestHelpersTest: test_assert_step_executed_checks_for_completed_step
--------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.820511"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.820511"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.820998"], ["current_step_name", nil], ["hero_id", 105], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:39:22.820998"]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 82], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.822444"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.821364"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.822444"], ["workflow_id", 82]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.822872"], ["id", 82]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 674513dd-c0da-4593-ae31-c0cfeff0d9b4) to Test(default) with arguments: 132
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "674513dd-c0da-4593-ae31-c0cfeff0d9b4"], ["updated_at", "2025-12-17 15:39:22.823219"], ["id", 132]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 82], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 132], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.824933"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.825016"], ["id", 132]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.825849"], ["id", 82]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 132], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.827222"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.827335"], ["id", 132]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.828175"], ["id", 82]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 82], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.830006"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.828567"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.830006"], ["workflow_id", 82]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:39:22.830419"], ["id", 82]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 67141b1f-c4df-465e-a797-3cc8d0a22245) to Test(default) with arguments: 133
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "67141b1f-c4df-465e-a797-3cc8d0a22245"], ["updated_at", "2025-12-17 15:39:22.830783"], ["id", 133]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 82], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 133], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.832397"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.832484"], ["id", 133]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.833333"], ["id", 82]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 133], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.834614"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.834704"], ["id", 133]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.835544"], ["id", 82]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 82], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.837057"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.835924"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.837057"], ["workflow_id", 82]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:39:22.837492"], ["id", 82]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 80ab81e1-38bf-497a-9a36-fbf2c7f5bb27) to Test(default) with arguments: 134
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "80ab81e1-38bf-497a-9a36-fbf2c7f5bb27"], ["updated_at", "2025-12-17 15:39:22.837848"], ["id", 134]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 82], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 134], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.839448"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.839540"], ["id", 134]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.840452"], ["id", 82]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 82], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 134], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.841621"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.841714"], ["id", 134]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.842534"], ["id", 82]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.843256"], ["updated_at", "2025-12-17 15:39:22.843322"], ["id", 82]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 82], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 82], ["step_name", "step_one"], ["state", "completed"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 82], ["step_name", "step_two"], ["state", "completed"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 82], ["step_name", "step_three"], ["state", "completed"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
TestHelpersTest: test_assert_step_executed_checks_for_skipped_step
------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.845722"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.845722"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.847440"], ["current_step_name", nil], ["hero_id", 106], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SkippingWorkflow"], ["updated_at", "2025-12-17 15:39:22.847440"]]
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 83], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.849173"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.847919"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first"], ["updated_at", "2025-12-17 15:39:22.849173"], ["workflow_id", 83]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first"], ["updated_at", "2025-12-17 15:39:22.849654"], ["id", 83]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4a0e5ba1-93a6-47fe-9e87-671b91dffe56) to Test(default) with arguments: 135
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4a0e5ba1-93a6-47fe-9e87-671b91dffe56"], ["updated_at", "2025-12-17 15:39:22.850056"], ["id", 135]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 83], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 135], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.851787"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.851871"], ["id", 135]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.852680"], ["id", 83]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 135], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.853905"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.853988"], ["id", 135]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.854819"], ["id", 83]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 83], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.856468"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.855181"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skipped"], ["updated_at", "2025-12-17 15:39:22.856468"], ["workflow_id", 83]]
  [1m[36mSkippingWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skipped"], ["updated_at", "2025-12-17 15:39:22.856865"], ["id", 83]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3435f1be-1fee-4617-8d42-71352f97c521) to Test(default) with arguments: 136
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3435f1be-1fee-4617-8d42-71352f97c521"], ["updated_at", "2025-12-17 15:39:22.857302"], ["id", 136]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 83], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 136], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.858944"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.859036"], ["id", 136]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.859865"], ["id", 83]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 136], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:39:22.861104"], ["state", "skipped"], ["updated_at", "2025-12-17 15:39:22.861183"], ["id", 136]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.862085"], ["id", 83]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 83], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.863555"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.862449"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "final"], ["updated_at", "2025-12-17 15:39:22.863555"], ["workflow_id", 83]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "final"], ["updated_at", "2025-12-17 15:39:22.863970"], ["id", 83]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: b0b7cdba-e25e-4ed6-a9cd-875ac523f53a) to Test(default) with arguments: 137
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "b0b7cdba-e25e-4ed6-a9cd-875ac523f53a"], ["updated_at", "2025-12-17 15:39:22.864308"], ["id", 137]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 83], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 137], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:39:22.865910"], ["state", "executing"], ["updated_at", "2025-12-17 15:39:22.865995"], ["id", 137]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:39:22.866942"], ["id", 83]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 83], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 137], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.868075"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.868157"], ["id", 137]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:39:22.868996"], ["id", 83]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.869731"], ["updated_at", "2025-12-17 15:39:22.869791"], ["id", 83]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 83], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 83], ["step_name", "skipped"], ["state", "skipped"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
GenevaDriveTest: test_it_has_a_version_number
---------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
WorkflowTest: test_workflow_with_wait_schedules_step_for_future
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.872157"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.872157"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.873711"], ["current_step_name", nil], ["hero_id", 107], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "WaitingWorkflow"], ["updated_at", "2025-12-17 15:39:22.873711"]]
  [1m[36mWaitingWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 84], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 84], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 84], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.875203"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.874084"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "immediate_step"], ["updated_at", "2025-12-17 15:39:22.875203"], ["workflow_id", 84]]
  [1m[36mWaitingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "immediate_step"], ["updated_at", "2025-12-17 15:39:22.875675"], ["id", 84]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: aade3de6-e7fc-48bb-8f2b-27f64e14280f) to Test(default) with arguments: 138
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "aade3de6-e7fc-48bb-8f2b-27f64e14280f"], ["updated_at", "2025-12-17 15:39:22.876046"], ["id", 138]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 84], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 138], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:39:22.877095"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:39:22.877181"], ["id", 138]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 84], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 84], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 84], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 84], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.879374"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-19 15:39:22.878177"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "delayed_step"], ["updated_at", "2025-12-17 15:39:22.879374"], ["workflow_id", 84]]
  [1m[36mWaitingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "delayed_step"], ["updated_at", "2025-12-17 15:39:22.879804"], ["id", 84]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7ef00f31-8302-4aa8-991b-fd3757fc5216) to Test(default) at 2025-12-19 15:39:22 UTC with arguments: 139
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7ef00f31-8302-4aa8-991b-fd3757fc5216"], ["updated_at", "2025-12-17 15:39:22.880236"], ["id", 139]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" DESC LIMIT $2[0m  [["workflow_id", 84], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_job_options_are_merged_from_parent
-----------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.881621"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.881621"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
WorkflowTest: test_creates_workflow_with_hero_and_schedules_first_step
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.882402"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.882402"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.883878"], ["current_step_name", nil], ["hero_id", 109], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:39:22.883878"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 85], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 85], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 85], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.885577"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.884272"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.885577"], ["workflow_id", 85]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.886044"], ["id", 85]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 70474b0c-b5dc-4b0a-bbfc-5e2b5f6957be) to Test(default) with arguments: 140
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "70474b0c-b5dc-4b0a-bbfc-5e2b5f6957be"], ["updated_at", "2025-12-17 15:39:22.886427"], ["id", 140]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 85]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 85], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_resume!_works_for_paused_workflows
-----------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.887739"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.887739"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.888197"], ["current_step_name", nil], ["hero_id", 110], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:39:22.888197"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 86], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 86], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 86], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.889636"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.888581"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.889636"], ["workflow_id", 86]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.890027"], ["id", 86]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3c6e19e7-838b-4905-aad8-e1c3ac513d23) to Test(default) with arguments: 141
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3c6e19e7-838b-4905-aad8-e1c3ac513d23"], ["updated_at", "2025-12-17 15:39:22.890411"], ["id", 141]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 86], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:39:22.891233"], ["updated_at", "2025-12-17 15:39:22.891298"], ["id", 86]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 86], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "ready"], ["transitioned_at", nil], ["updated_at", "2025-12-17 15:39:22.892095"], ["id", 86]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 86], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 86], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 141], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:39:22.893650"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:39:22.893735"], ["id", 141]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 86], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.894359"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.892503"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.894359"], ["workflow_id", 86]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 8ea56477-4549-4a15-bd38-5c74044d0239) to Test(default) with arguments: 142
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "8ea56477-4549-4a15-bd38-5c74044d0239"], ["updated_at", "2025-12-17 15:39:22.894881"], ["id", 142]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 86]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
WorkflowTest: test_step_collection_finds_next_step
--------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.895910"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.895910"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_step_collection_provides_ordered_steps
---------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.896713"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.896713"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
WorkflowTest: test_resume!_raises_for_non-paused_workflows
----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.897615"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.897615"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.898070"], ["current_step_name", nil], ["hero_id", 113], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:39:22.898070"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 87], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 87], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 87], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.899527"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.898442"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.899527"], ["workflow_id", 87]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.899961"], ["id", 87]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: fd79c78e-234f-457e-bad9-e72f42a78458) to Test(default) with arguments: 143
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "fd79c78e-234f-457e-bad9-e72f42a78458"], ["updated_at", "2025-12-17 15:39:22.900343"], ["id", 143]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
WorkflowTest: test_scopes_work_correctly
----------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.901213"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.901213"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.901661"], ["current_step_name", nil], ["hero_id", 114], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:39:22.901661"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 88], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 88], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 88], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.903175"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.902012"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.903175"], ["workflow_id", 88]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.903597"], ["id", 88]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7010ec89-63bc-478b-afa3-22f199cb2424) to Test(default) with arguments: 144
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7010ec89-63bc-478b-afa3-22f199cb2424"], ["updated_at", "2025-12-17 15:39:22.903954"], ["id", 144]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", true], ["created_at", "2025-12-17 15:39:22.904395"], ["current_step_name", nil], ["hero_id", 114], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:39:22.904395"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 89], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 89], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 89], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.905872"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.904767"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.905872"], ["workflow_id", 89]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.906263"], ["id", 89]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 02293ca3-9662-4b3d-bf7d-5905f276ac55) to Test(default) with arguments: 145
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "02293ca3-9662-4b3d-bf7d-5905f276ac55"], ["updated_at", "2025-12-17 15:39:22.906631"], ["id", 145]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 89], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.907373"], ["updated_at", "2025-12-17 15:39:22.907435"], ["id", 89]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "ready"], ["id", 88], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "finished"], ["id", 89], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 88], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 89], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."hero_type" = $1 AND "geneva_drive_workflows"."hero_id" = $2[0m  [["hero_type", "User"], ["hero_id", 114]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_may_proceed_without_hero!_is_inherited
---------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.909582"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.909582"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
WorkflowTest: test_transitioned_at_is_set_when_transitioning_to_terminal_states
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.910363"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.910363"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:39:22.910845"], ["current_step_name", nil], ["hero_id", 116], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:39:22.910845"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 90], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 90], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 90], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:39:22.912299"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:39:22.911208"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.912299"], ["workflow_id", 90]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:39:22.912741"], ["id", 90]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: f5a24b74-803a-42b0-8829-1c48b70cdaa0) to Test(default) with arguments: 146
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "f5a24b74-803a-42b0-8829-1c48b70cdaa0"], ["updated_at", "2025-12-17 15:39:22.913117"], ["id", 146]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 90], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:39:22.913830"], ["updated_at", "2025-12-17 15:39:22.913896"], ["id", 90]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_cancel_if_conditions_are_inherited
-----------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.914674"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.914674"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
WorkflowTest: test_step_definitions_are_inherited
-------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:39:22.915498"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:39:22.915498"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
Generating image variants require the image_processing gem. Please add `gem "image_processing", "~> 1.2"` to your Gemfile or set `config.active_storage.variant_processor = :disabled`.
  [1m[36mActiveRecord::InternalMetadata Load (1.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1[0m  [[nil, "schema_sha1"]]
  [1m[36mActiveRecord::SchemaMigration Load (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------
ExecutorTest: test_on_exception:_:skip!_skips_step_on_error
-----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:33.874057"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:33.874057"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (1.0ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:33.883099"], ["current_step_name", nil], ["hero_id", 119], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:41:33.883099"]]
  [1m[36mExceptionTestWorkflow Load (0.7ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 91], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (1.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 91], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 91], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.6ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.902163"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.884502"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:41:33.902163"], ["workflow_id", 91]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:41:33.903246"], ["id", 91]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 2f3a0410-1d33-4ebb-bac7-4983d1d55968) to Test(default) with arguments: 147
  [1m[36mGenevaDrive::StepExecution Update (0.5ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "2f3a0410-1d33-4ebb-bac7-4983d1d55968"], ["updated_at", "2025-12-17 15:41:33.923358"], ["id", 147]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 91], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 147], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:33.925665"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:33.925772"], ["id", 147]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 91], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.926825"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.926268"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_error"], ["updated_at", "2025-12-17 15:41:33.926825"], ["workflow_id", 91]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skip_error"], ["updated_at", "2025-12-17 15:41:33.927462"], ["id", 91]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 148], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:33.929096"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:33.929192"], ["id", 148]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 91], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:33.930265"], ["id", 91]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 119], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 91], ["LIMIT", 1]]
Step execution 148 failed: skip error
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 148], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:41:33.932677"], ["state", "skipped"], ["updated_at", "2025-12-17 15:41:33.932767"], ["id", 148]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 91], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:33.933758"], ["id", 91]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 91], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 91], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 91], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.935676"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.934349"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:41:33.935676"], ["workflow_id", 91]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_error"], ["updated_at", "2025-12-17 15:41:33.936107"], ["id", 91]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4633689d-b4b0-40e1-8ed7-b3d501e02d88) to Test(default) with arguments: 149
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4633689d-b4b0-40e1-8ed7-b3d501e02d88"], ["updated_at", "2025-12-17 15:41:33.936512"], ["id", 149]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 148], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 91], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_pause!_flow_control_pauses_workflow
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:33.939832"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:33.939832"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:33.941539"], ["current_step_name", nil], ["hero_id", 120], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:41:33.941539"]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 92], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 92], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 92], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.943439"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.941985"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:33.943439"], ["workflow_id", 92]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:33.943926"], ["id", 92]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 793a31a8-f4fd-42db-a757-7d8345e53043) to Test(default) with arguments: 150
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "793a31a8-f4fd-42db-a757-7d8345e53043"], ["updated_at", "2025-12-17 15:41:33.944344"], ["id", 150]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 92], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 150], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:33.945513"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:33.945606"], ["id", 150]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 92], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.946609"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.946004"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_step"], ["updated_at", "2025-12-17 15:41:33.946609"], ["workflow_id", 92]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_step"], ["updated_at", "2025-12-17 15:41:33.947096"], ["id", 92]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 151], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:33.947827"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:33.947917"], ["id", 151]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 92], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:33.948752"], ["id", 92]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 120], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 92], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 151], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:33.949994"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:33.950092"], ["id", 151]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 92], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:41:33.951169"], ["updated_at", "2025-12-17 15:41:33.951244"], ["id", 92]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 151], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 92], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------------
ExecutorTest: test_step_execution_idempotency_-_does_not_re-execute_completed_step
----------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:33.952756"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:33.952756"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:33.954562"], ["current_step_name", nil], ["hero_id", 121], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:41:33.954562"]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 93], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 93], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 93], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.956956"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.955002"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:41:33.956956"], ["workflow_id", 93]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:41:33.958436"], ["id", 93]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c1cbc5fd-820f-4a97-8508-34a668440844) to Test(default) with arguments: 152
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c1cbc5fd-820f-4a97-8508-34a668440844"], ["updated_at", "2025-12-17 15:41:33.959191"], ["id", 152]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 93], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 152], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.4ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:33.961616"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:33.962233"], ["id", 152]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 93], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:33.965742"], ["id", 93]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 121], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 93], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 152], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:33.968614"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:33.968727"], ["id", 152]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 93], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:33.971023"], ["id", 93]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 93], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 93], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 93], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.975820"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.972656"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:41:33.975820"], ["workflow_id", 93]]
  [1m[36mExecutorTestWorkflow Update (0.7ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:41:33.976329"], ["id", 93]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3e1f59fe-a9ad-4149-93c5-74892a5d5733) to Test(default) with arguments: 153
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3e1f59fe-a9ad-4149-93c5-74892a5d5733"], ["updated_at", "2025-12-17 15:41:33.978373"], ["id", 153]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 93], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 152], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 152], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------
ExecutorTest: test_skip_if_condition_evaluated_at_execution_time
----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:33.983414"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:33.983414"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:33.985000"], ["email", "[FILTERED]"], ["name", "Skip"], ["updated_at", "2025-12-17 15:41:33.985000"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:33.988500"], ["current_step_name", nil], ["hero_id", 123], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SkipIfTestWorkflow"], ["updated_at", "2025-12-17 15:41:33.988500"]]
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 94], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 94], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 94], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.991032"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.989011"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skippable"], ["updated_at", "2025-12-17 15:41:33.991032"], ["workflow_id", 94]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skippable"], ["updated_at", "2025-12-17 15:41:33.991539"], ["id", 94]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 08216d8e-6d84-4bbf-aa9d-fcb2413fa9e9) to Test(default) with arguments: 154
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "08216d8e-6d84-4bbf-aa9d-fcb2413fa9e9"], ["updated_at", "2025-12-17 15:41:33.992011"], ["id", 154]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 94], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 154], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:33.993241"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:33.993349"], ["id", 154]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 94], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:33.994227"], ["id", 94]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 123], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 94], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 154], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:41:33.995527"], ["state", "skipped"], ["updated_at", "2025-12-17 15:41:33.995635"], ["id", 154]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 94], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:33.996485"], ["id", 94]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkipIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkipIfTestWorkflow"], ["id", 94], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 94], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 94], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:33.998251"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:33.997040"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "final"], ["updated_at", "2025-12-17 15:41:33.998251"], ["workflow_id", 94]]
  [1m[36mSkipIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "final"], ["updated_at", "2025-12-17 15:41:33.998685"], ["id", 94]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 59d2c3e2-fdeb-4155-9f74-fa06874ae09b) to Test(default) with arguments: 155
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "59d2c3e2-fdeb-4155-9f74-fa06874ae09b"], ["updated_at", "2025-12-17 15:41:33.999070"], ["id", 155]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 154], ["LIMIT", 1]]
  [1m[36mSkipIfTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkipIfTestWorkflow"], ["id", 94], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_skip!_flow_control_skips_to_next_step
--------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.000543"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.000543"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.001185"], ["current_step_name", nil], ["hero_id", 124], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.001185"]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 95], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 95], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 95], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.002845"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.001548"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:34.002845"], ["workflow_id", 95]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:34.003476"], ["id", 95]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: a5b6e09a-0481-45b0-8c6a-5722ff00aed1) to Test(default) with arguments: 156
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "a5b6e09a-0481-45b0-8c6a-5722ff00aed1"], ["updated_at", "2025-12-17 15:41:34.003908"], ["id", 156]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 95], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 156], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.005170"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.005283"], ["id", 156]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 95], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.006157"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.005714"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skip_step"], ["updated_at", "2025-12-17 15:41:34.006157"], ["workflow_id", 95]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skip_step"], ["updated_at", "2025-12-17 15:41:34.006681"], ["id", 95]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 157], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.007454"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.007547"], ["id", 157]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 95], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.008452"], ["id", 95]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 124], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 95], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 157], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:41:34.009828"], ["state", "skipped"], ["updated_at", "2025-12-17 15:41:34.009921"], ["id", 157]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 95], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.010835"], ["id", 95]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 95], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 95], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 95], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.012624"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.011322"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "reattempt_step"], ["updated_at", "2025-12-17 15:41:34.012624"], ["workflow_id", 95]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "reattempt_step"], ["updated_at", "2025-12-17 15:41:34.013065"], ["id", 95]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7e1657d3-c4fb-4af5-b68c-d8351f588dab) to Test(default) with arguments: 158
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7e1657d3-c4fb-4af5-b68c-d8351f588dab"], ["updated_at", "2025-12-17 15:41:34.013496"], ["id", 158]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 157], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 95], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 95]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ExecutorTest: test_calls_before_step_starts_hook
------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.015470"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.015470"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.017245"], ["current_step_name", nil], ["hero_id", 125], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HookTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.017245"]]
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 96], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 96], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 96], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.018995"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.017658"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "tracked_step"], ["updated_at", "2025-12-17 15:41:34.018995"], ["workflow_id", 96]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "tracked_step"], ["updated_at", "2025-12-17 15:41:34.019466"], ["id", 96]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4206465a-24eb-4ccb-b155-f3570df5042b) to Test(default) with arguments: 159
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4206465a-24eb-4ccb-b155-f3570df5042b"], ["updated_at", "2025-12-17 15:41:34.019931"], ["id", 159]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 96], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 159], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.021102"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.021203"], ["id", 159]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 96], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.022049"], ["id", 96]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 125], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 96], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 159], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.023302"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.023389"], ["id", 159]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 96], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.024274"], ["id", 96]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHookTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HookTestWorkflow"], ["id", 96], ["LIMIT", 1]]
  [1m[36mHookTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.025034"], ["updated_at", "2025-12-17 15:41:34.025099"], ["id", 96]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
ExecutorTest: test_cancels_workflow_if_hero_is_deleted
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.025989"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.025989"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.027638"], ["current_step_name", nil], ["hero_id", 126], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "NoHeroTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.027638"]]
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 97], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 97], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 97], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.029358"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.028086"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.029358"], ["workflow_id", 97]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.029810"], ["id", 97]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: dc1729e4-2639-4be6-88d1-3ef6e15588e8) to Test(default) with arguments: 160
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "dc1729e4-2639-4be6-88d1-3ef6e15588e8"], ["updated_at", "2025-12-17 15:41:34.030395"], ["id", 160]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 97], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 126]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 97], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 160], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.032498"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.032597"], ["id", 160]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 97], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.033538"], ["id", 97]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 126], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 160], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.034551"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.034642"], ["id", 160]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mNoHeroTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "NoHeroTestWorkflow"], ["id", 97], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:41:34.035452"], ["updated_at", "2025-12-17 15:41:34.035533"], ["id", 97]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 160], ["LIMIT", 1]]
  [1m[36mNoHeroTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "NoHeroTestWorkflow"], ["id", 97], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_cancel!_flow_control_cancels_workflow
--------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.036912"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.036912"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.037411"], ["current_step_name", nil], ["hero_id", 127], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.037411"]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 98], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 98], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 98], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.038950"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.037763"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:34.038950"], ["workflow_id", 98]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:34.039387"], ["id", 98]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c7744ddb-8b08-4908-91de-405072d48814) to Test(default) with arguments: 161
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c7744ddb-8b08-4908-91de-405072d48814"], ["updated_at", "2025-12-17 15:41:34.039778"], ["id", 161]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 98], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 161], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.040796"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.040891"], ["id", 161]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 98], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.041777"], ["id", 98]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 127], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 98], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 161], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.043114"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.043222"], ["id", 161]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 98], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:41:34.044087"], ["updated_at", "2025-12-17 15:41:34.044163"], ["id", 98]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 161], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 98], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------
ExecutorTest: test_executes_step_and_transitions_to_next
--------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.045487"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.045487"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.045978"], ["current_step_name", nil], ["hero_id", 128], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExecutorTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.045978"]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 99], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 99], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 99], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.047483"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.046351"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first_step"], ["updated_at", "2025-12-17 15:41:34.047483"], ["workflow_id", 99]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first_step"], ["updated_at", "2025-12-17 15:41:34.047921"], ["id", 99]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: e1fecd5b-1860-4735-b71b-ed4fe3fa9075) to Test(default) with arguments: 162
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "e1fecd5b-1860-4735-b71b-ed4fe3fa9075"], ["updated_at", "2025-12-17 15:41:34.048330"], ["id", 162]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 99], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 162], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.049349"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.049454"], ["id", 162]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 99], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.050350"], ["id", 99]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 128], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 99], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 162], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.051661"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.051763"], ["id", 162]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 99], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.052621"], ["id", 99]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExecutorTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExecutorTestWorkflow"], ["id", 99], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 99], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 99], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.054192"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.053011"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "second_step"], ["updated_at", "2025-12-17 15:41:34.054192"], ["workflow_id", 99]]
  [1m[36mExecutorTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "second_step"], ["updated_at", "2025-12-17 15:41:34.054627"], ["id", 99]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: c7c87632-a347-40a6-b211-be5f83cd1f66) to Test(default) with arguments: 163
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "c7c87632-a347-40a6-b211-be5f83cd1f66"], ["updated_at", "2025-12-17 15:41:34.055009"], ["id", 163]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 162], ["LIMIT", 1]]
  [1m[36mExecutorTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExecutorTestWorkflow"], ["id", 99], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 99]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
ExecutorTest: test_on_exception:_:cancel!_cancels_workflow_on_error
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.056612"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.056612"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.057085"], ["current_step_name", nil], ["hero_id", 129], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.057085"]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 100], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 100], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 100], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.058499"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.057417"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:41:34.058499"], ["workflow_id", 100]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:41:34.058936"], ["id", 100]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: cfcd26ed-32f6-4443-be92-f034e9cee824) to Test(default) with arguments: 164
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "cfcd26ed-32f6-4443-be92-f034e9cee824"], ["updated_at", "2025-12-17 15:41:34.059346"], ["id", 164]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 100], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 164], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.060546"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.060636"], ["id", 164]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 100], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.1ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.061422"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.061019"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_error"], ["updated_at", "2025-12-17 15:41:34.061422"], ["workflow_id", 100]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_error"], ["updated_at", "2025-12-17 15:41:34.061879"], ["id", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 165], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.062673"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.062766"], ["id", 165]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 100], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.063616"], ["id", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 129], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 100], ["LIMIT", 1]]
Step execution 165 failed: cancel error
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 165], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.5ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "error_backtrace" = $1, "error_message" = $2, "failed_at" = $3, "outcome" = $4, "state" = $5, "updated_at" = $6 WHERE "geneva_drive_step_executions"."id" = $7[0m  [["error_backtrace", "/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:120:in 'block in <class:ExceptionTestWorkflow>'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'BasicObject#instance_exec'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'GenevaDrive::StepDefinition#execute_in_context'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:67:in 'block in GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'Kernel#catch'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:341:in 'block in <class:ExecutorTest>'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:95:in 'block (2 levels) in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:191:in 'Minitest::Test#capture_exceptions'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:90:in 'block in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:382:in 'Minitest::Runnable#time_it'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:89:in 'Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'block in ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/execution_wrapper.rb:104:in 'ActiveSupport::ExecutionWrapper.perform'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:1223:in 'Minitest.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:462:in 'Minitest::Runnable.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:449:in 'block (2 levels) in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'Array#each'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'block in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:487:in 'Minitest::Runnable.on_signal'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:474:in 'Minitest::Runnable.with_info_handler'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:444:in 'Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/railties-8.1.1/lib/rails/test_unit/line_filtering.rb:10:in 'Rails::LineFiltering#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'block in Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Array#map'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:301:in 'Minitest.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:85:in 'block in Minitest.autorun'"], ["error_message", "cancel error"], ["failed_at", "2025-12-17 15:41:34.064891"], ["outcome", "canceled"], ["state", "failed"], ["updated_at", "2025-12-17 15:41:34.064997"], ["id", 165]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 100], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:41:34.066203"], ["updated_at", "2025-12-17 15:41:34.066279"], ["id", 100]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 165], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 100], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------
ExecutorTest: test_on_exception:_:pause!_pauses_workflow_on_error
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.067637"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.067637"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.068096"], ["current_step_name", nil], ["hero_id", 130], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "ExceptionTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.068096"]]
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 101], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 101], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 101], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.069577"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.068431"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "pause_default"], ["updated_at", "2025-12-17 15:41:34.069577"], ["workflow_id", 101]]
  [1m[36mExceptionTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "pause_default"], ["updated_at", "2025-12-17 15:41:34.070027"], ["id", 101]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 0350c2e5-d3f9-4077-ad3c-d33ad7ff0b79) to Test(default) with arguments: 166
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "0350c2e5-d3f9-4077-ad3c-d33ad7ff0b79"], ["updated_at", "2025-12-17 15:41:34.070407"], ["id", 166]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 101], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 166], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.071326"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.071408"], ["id", 166]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 101], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.072238"], ["id", 101]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 130], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 101], ["LIMIT", 1]]
Step execution 166 failed: pause error
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 166], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "error_backtrace" = $1, "error_message" = $2, "failed_at" = $3, "outcome" = $4, "state" = $5, "updated_at" = $6 WHERE "geneva_drive_step_executions"."id" = $7[0m  [["error_backtrace", "/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:108:in 'block in <class:ExceptionTestWorkflow>'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'BasicObject#instance_exec'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/step_definition.rb:73:in 'GenevaDrive::StepDefinition#execute_in_context'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:67:in 'block in GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'Kernel#catch'\n/Users/julik/Code/geneva_drive/geneva_drive/lib/geneva_drive/executor.rb:66:in 'GenevaDrive::Executor#execute!'\n/Users/julik/Code/geneva_drive/geneva_drive/test/executor_test.rb:299:in 'block in <class:ExecutorTest>'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:95:in 'block (2 levels) in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:191:in 'Minitest::Test#capture_exceptions'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:90:in 'block in Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:382:in 'Minitest::Runnable#time_it'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest/test.rb:89:in 'Minitest::Test#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'block in ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/execution_wrapper.rb:104:in 'ActiveSupport::ExecutionWrapper.perform'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/activesupport-8.1.1/lib/active_support/executor/test_helper.rb:5:in 'ActiveSupport::Executor::TestHelper#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:1223:in 'Minitest.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:462:in 'Minitest::Runnable.run_one_method'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:449:in 'block (2 levels) in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'Array#each'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:445:in 'block in Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:487:in 'Minitest::Runnable.on_signal'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:474:in 'Minitest::Runnable.with_info_handler'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:444:in 'Minitest::Runnable.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/railties-8.1.1/lib/rails/test_unit/line_filtering.rb:10:in 'Rails::LineFiltering#run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'block in Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Array#map'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:346:in 'Minitest.__run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:301:in 'Minitest.run'\n/Users/julik/.rbenv/versions/3.4.4/lib/ruby/gems/3.4.0/gems/minitest-5.27.0/lib/minitest.rb:85:in 'block in Minitest.autorun'"], ["error_message", "pause error"], ["failed_at", "2025-12-17 15:41:34.073484"], ["outcome", "failed"], ["state", "failed"], ["updated_at", "2025-12-17 15:41:34.073568"], ["id", 166]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mExceptionTestWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "ExceptionTestWorkflow"], ["id", 101], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:41:34.074529"], ["updated_at", "2025-12-17 15:41:34.074591"], ["id", 101]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 166], ["LIMIT", 1]]
  [1m[36mExceptionTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "ExceptionTestWorkflow"], ["id", 101], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------------
ExecutorTest: test_finished!_flow_control_finishes_workflow_immediately
-----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.075870"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.075870"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.076351"], ["current_step_name", nil], ["hero_id", 131], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "FlowControlTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.076351"]]
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 102], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 102], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 102], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.077938"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.076706"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:34.077938"], ["workflow_id", 102]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "cancel_step"], ["updated_at", "2025-12-17 15:41:34.078389"], ["id", 102]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: e4a71606-4837-4fc9-b35f-9400b32840e0) to Test(default) with arguments: 167
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "e4a71606-4837-4fc9-b35f-9400b32840e0"], ["updated_at", "2025-12-17 15:41:34.078823"], ["id", 167]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 102], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 167], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.079982"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.080074"], ["id", 167]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 102], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.080884"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.080493"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "finish_step"], ["updated_at", "2025-12-17 15:41:34.080884"], ["workflow_id", 102]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "finish_step"], ["updated_at", "2025-12-17 15:41:34.081391"], ["id", 102]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 168], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.082130"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.082214"], ["id", 168]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 102], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.083069"], ["id", 102]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 131], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 102], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 168], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.084308"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.084399"], ["id", 168]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mFlowControlTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "FlowControlTestWorkflow"], ["id", 102], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.085173"], ["updated_at", "2025-12-17 15:41:34.085244"], ["id", 102]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 168], ["LIMIT", 1]]
  [1m[36mFlowControlTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "FlowControlTestWorkflow"], ["id", 102], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------------
ExecutorTest: test_proceeds_without_hero_if_may_proceed_without_hero!_is_set
----------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.086577"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.086577"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.088357"], ["current_step_name", nil], ["hero_id", 132], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "HeroOptionalWorkflow"], ["updated_at", "2025-12-17 15:41:34.088357"]]
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 103], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 103], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 103], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.090041"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.088794"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.090041"], ["workflow_id", 103]]
  [1m[36mHeroOptionalWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.090469"], ["id", 103]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 951fcefe-175f-4002-bbe3-267e2fb3852a) to Test(default) with arguments: 169
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "951fcefe-175f-4002-bbe3-267e2fb3852a"], ["updated_at", "2025-12-17 15:41:34.090879"], ["id", 169]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 103], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.2ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 132]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 103], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 169], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.092783"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.092869"], ["id", 169]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.4ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 103], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.093930"], ["id", 103]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 103], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 169], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.094961"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.095053"], ["id", 169]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 103], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.095920"], ["id", 103]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mHeroOptionalWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "HeroOptionalWorkflow"], ["id", 103], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.096677"], ["updated_at", "2025-12-17 15:41:34.096746"], ["id", 103]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 169], ["LIMIT", 1]]
  [1m[36mHeroOptionalWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "HeroOptionalWorkflow"], ["id", 103], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------
ExecutorTest: test_cancel_if_condition_cancels_workflow
-------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.098070"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.098070"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.1ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.098539"], ["email", "[FILTERED]"], ["name", "Cancel"], ["updated_at", "2025-12-17 15:41:34.098539"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.100035"], ["current_step_name", nil], ["hero_id", 134], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "CancelIfTestWorkflow"], ["updated_at", "2025-12-17 15:41:34.100035"]]
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 104], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 104], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 104], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.101681"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.100464"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first"], ["updated_at", "2025-12-17 15:41:34.101681"], ["workflow_id", 104]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first"], ["updated_at", "2025-12-17 15:41:34.102147"], ["id", 104]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 0a8d2c50-60b4-4984-8ecc-3db3e6b336e5) to Test(default) with arguments: 170
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "0a8d2c50-60b4-4984-8ecc-3db3e6b336e5"], ["updated_at", "2025-12-17 15:41:34.102534"], ["id", 170]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 104], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 170], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.103714"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.103798"], ["id", 170]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 104], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.104660"], ["id", 104]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 134], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 170], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.105626"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.105726"], ["id", 170]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mCancelIfTestWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "CancelIfTestWorkflow"], ["id", 104], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "canceled"], ["transitioned_at", "2025-12-17 15:41:34.106493"], ["updated_at", "2025-12-17 15:41:34.106562"], ["id", 104]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2[0m  [["id", 170], ["LIMIT", 1]]
  [1m[36mCancelIfTestWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "CancelIfTestWorkflow"], ["id", 104], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
GenevaDriveTest: test_it_has_a_version_number
---------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------
TestHelpersTest: test_speedrun_workflow_stops_on_pause
------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.108340"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.108340"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.109896"], ["current_step_name", nil], ["hero_id", 135], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "PausingWorkflow"], ["updated_at", "2025-12-17 15:41:34.109896"]]
  [1m[36mPausingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "PausingWorkflow"], ["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 105], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.111465"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.110308"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "will_pause"], ["updated_at", "2025-12-17 15:41:34.111465"], ["workflow_id", 105]]
  [1m[36mPausingWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "will_pause"], ["updated_at", "2025-12-17 15:41:34.112032"], ["id", 105]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: a4e61afc-eab3-4b6f-9cba-a1db72130fcb) to Test(default) with arguments: 171
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "a4e61afc-eab3-4b6f-9cba-a1db72130fcb"], ["updated_at", "2025-12-17 15:41:34.112482"], ["id", 171]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "PausingWorkflow"], ["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 105], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 171], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.114241"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.114361"], ["id", 171]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "PausingWorkflow"], ["id", 105], ["LIMIT", 1]]
  [1m[36mPausingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.115381"], ["id", 105]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 135], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 105], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 171], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.116649"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.116755"], ["id", 171]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "PausingWorkflow"], ["id", 105], ["LIMIT", 1]]
  [1m[36mPausingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:41:34.117569"], ["updated_at", "2025-12-17 15:41:34.117635"], ["id", 105]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mPausingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "PausingWorkflow"], ["id", 105], ["LIMIT", 1]]
  [1m[36mPausingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "PausingWorkflow"], ["id", 105], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 105]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------
TestHelpersTest: test_speedrun_workflow_runs_workflow_to_completion
-------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.119308"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.119308"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.120981"], ["current_step_name", nil], ["hero_id", 136], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:41:34.120981"]]
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 106], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.122605"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.121372"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.122605"], ["workflow_id", 106]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.123060"], ["id", 106]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 6a070939-d5c5-4e6f-a380-8fb57d1701e6) to Test(default) with arguments: 172
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "6a070939-d5c5-4e6f-a380-8fb57d1701e6"], ["updated_at", "2025-12-17 15:41:34.123516"], ["id", 172]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 106], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 172], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.125107"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.125193"], ["id", 172]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.126009"], ["id", 106]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 136], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 172], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.127183"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.127286"], ["id", 172]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.128124"], ["id", 106]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 106], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.129653"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.128512"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.129653"], ["workflow_id", 106]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.130095"], ["id", 106]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3185965b-4abb-4374-987f-ee970d77ffcf) to Test(default) with arguments: 173
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3185965b-4abb-4374-987f-ee970d77ffcf"], ["updated_at", "2025-12-17 15:41:34.130451"], ["id", 173]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 106], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 173], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.132147"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.132229"], ["id", 173]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.133246"], ["id", 106]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 136], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 173], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.134478"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.134568"], ["id", 173]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.135477"], ["id", 106]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 106], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.137043"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.135870"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.137043"], ["workflow_id", 106]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.137498"], ["id", 106]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: ed354887-24f5-41bb-a3a7-9d6ba51bd7f8) to Test(default) with arguments: 174
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "ed354887-24f5-41bb-a3a7-9d6ba51bd7f8"], ["updated_at", "2025-12-17 15:41:34.137858"], ["id", 174]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 106], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 174], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.139459"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.139539"], ["id", 174]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.140524"], ["id", 106]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 136], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 106], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 174], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.141676"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.141759"], ["id", 174]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.142710"], ["id", 106]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.143418"], ["updated_at", "2025-12-17 15:41:34.143477"], ["id", 106]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 106], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" = $2[0m  [["workflow_id", 106], ["state", "completed"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------------------------
TestHelpersTest: test_assert_step_executed_checks_for_completed_step
--------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.145208"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.145208"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.145711"], ["current_step_name", nil], ["hero_id", 137], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:41:34.145711"]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 107], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.147259"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.146099"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.147259"], ["workflow_id", 107]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.147728"], ["id", 107]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: de39714a-ad29-4333-affd-a7f916e8ebcb) to Test(default) with arguments: 175
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "de39714a-ad29-4333-affd-a7f916e8ebcb"], ["updated_at", "2025-12-17 15:41:34.148161"], ["id", 175]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 107], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 175], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.149780"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.149897"], ["id", 175]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.150836"], ["id", 107]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 137], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 175], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.152110"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.152212"], ["id", 175]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.153112"], ["id", 107]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 107], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.154648"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.153498"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.154648"], ["workflow_id", 107]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.155059"], ["id", 107]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7c955bde-36c1-434b-862a-310672d4f00c) to Test(default) with arguments: 176
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7c955bde-36c1-434b-862a-310672d4f00c"], ["updated_at", "2025-12-17 15:41:34.155421"], ["id", 176]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 107], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 176], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.157026"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.157107"], ["id", 176]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.157962"], ["id", 107]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 137], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 176], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.159134"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.159216"], ["id", 176]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.160065"], ["id", 107]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 107], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.161569"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.160414"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.161569"], ["workflow_id", 107]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.161990"], ["id", 107]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 151f7cf4-0359-4a8f-9678-915ac66e2230) to Test(default) with arguments: 177
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "151f7cf4-0359-4a8f-9678-915ac66e2230"], ["updated_at", "2025-12-17 15:41:34.162351"], ["id", 177]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.4ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 107], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 177], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.164281"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.164367"], ["id", 177]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.165255"], ["id", 107]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 137], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 107], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 177], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.166469"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.166554"], ["id", 177]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.167417"], ["id", 107]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.168116"], ["updated_at", "2025-12-17 15:41:34.168174"], ["id", 107]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 107], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 107], ["step_name", "step_one"], ["state", "completed"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 107], ["step_name", "step_two"], ["state", "completed"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 107], ["step_name", "step_three"], ["state", "completed"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------------------------
TestHelpersTest: test_assert_step_executed_checks_for_skipped_step
------------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.176497"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.176497"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Create (0.3ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.178281"], ["current_step_name", nil], ["hero_id", 138], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SkippingWorkflow"], ["updated_at", "2025-12-17 15:41:34.178281"]]
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 108], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.180495"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.178739"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "first"], ["updated_at", "2025-12-17 15:41:34.180495"], ["workflow_id", 108]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "first"], ["updated_at", "2025-12-17 15:41:34.180963"], ["id", 108]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 2b945863-11d7-463c-845b-f633b4efd1d8) to Test(default) with arguments: 178
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "2b945863-11d7-463c-845b-f633b4efd1d8"], ["updated_at", "2025-12-17 15:41:34.181419"], ["id", 178]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 108], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 178], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.183438"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.183526"], ["id", 178]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.184382"], ["id", 108]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 138], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 178], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.185568"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.185656"], ["id", 178]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.186479"], ["id", 108]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 108], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.188291"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.186847"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "skipped"], ["updated_at", "2025-12-17 15:41:34.188291"], ["workflow_id", 108]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "skipped"], ["updated_at", "2025-12-17 15:41:34.188708"], ["id", 108]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: f5f39a2c-a0f3-42af-93c8-09d0b09d4ff8) to Test(default) with arguments: 179
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "f5f39a2c-a0f3-42af-93c8-09d0b09d4ff8"], ["updated_at", "2025-12-17 15:41:34.189074"], ["id", 179]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 108], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 179], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.3ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.190687"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.190769"], ["id", 179]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.191986"], ["id", 108]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 138], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 179], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "outcome" = $1, "skipped_at" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["outcome", "skipped"], ["skipped_at", "2025-12-17 15:41:34.193225"], ["state", "skipped"], ["updated_at", "2025-12-17 15:41:34.193316"], ["id", 179]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.194157"], ["id", 108]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 108], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.195931"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.194531"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "final"], ["updated_at", "2025-12-17 15:41:34.195931"], ["workflow_id", 108]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "final"], ["updated_at", "2025-12-17 15:41:34.196334"], ["id", 108]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7adc3650-d75a-47f4-9a3c-dda89b6a3aff) to Test(default) with arguments: 180
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7adc3650-d75a-47f4-9a3c-dda89b6a3aff"], ["updated_at", "2025-12-17 15:41:34.196678"], ["id", 180]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 108], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 180], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.198277"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.198363"], ["id", 180]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.199375"], ["id", 108]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 138], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 108], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 180], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.200931"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.201038"], ["id", 180]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.201937"], ["id", 108]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.202659"], ["updated_at", "2025-12-17 15:41:34.202737"], ["id", 108]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mSkippingWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "SkippingWorkflow"], ["id", 108], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."step_name" = $2 AND "geneva_drive_step_executions"."state" = $3 LIMIT $4[0m  [["workflow_id", 108], ["step_name", "skipped"], ["state", "skipped"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
TestHelpersTest: test_step_workflow_executes_one_step_at_a_time
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.204527"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.204527"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.205044"], ["current_step_name", nil], ["hero_id", 139], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:41:34.205044"]]
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 109], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.206672"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.205541"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.206672"], ["workflow_id", 109]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.207105"], ["id", 109]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: f66e4231-00ff-43b0-adac-2642b38e7819) to Test(default) with arguments: 181
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "f66e4231-00ff-43b0-adac-2642b38e7819"], ["updated_at", "2025-12-17 15:41:34.207519"], ["id", 181]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 109], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 181], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.209122"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.209205"], ["id", 181]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.210040"], ["id", 109]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 139], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 181], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.211285"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.211369"], ["id", 181]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.212202"], ["id", 109]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 109], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.213680"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.212553"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.213680"], ["workflow_id", 109]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.214095"], ["id", 109]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: e02dddc2-c419-46b2-bcb1-7f8d3ffab7bc) to Test(default) with arguments: 182
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "e02dddc2-c419-46b2-bcb1-7f8d3ffab7bc"], ["updated_at", "2025-12-17 15:41:34.214464"], ["id", 182]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 109], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 182], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.216269"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.216355"], ["id", 182]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.217239"], ["id", 109]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 139], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 182], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.218440"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.218523"], ["id", 182]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.219412"], ["id", 109]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 109], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.220987"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.219840"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.220987"], ["workflow_id", 109]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.221417"], ["id", 109]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7c9809ef-16e1-4613-9cfb-90bb5b55a06a) to Test(default) with arguments: 183
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7c9809ef-16e1-4613-9cfb-90bb5b55a06a"], ["updated_at", "2025-12-17 15:41:34.221804"], ["id", 183]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 109], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 183], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.223730"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.223820"], ["id", 183]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.224653"], ["id", 109]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 139], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 109], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 183], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.225834"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.225921"], ["id", 183]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.226728"], ["id", 109]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.227430"], ["updated_at", "2025-12-17 15:41:34.227488"], ["id", 109]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 109], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------------------
TestHelpersTest: test_assert_workflow_state_checks_workflow_state
-----------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.228493"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.228493"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.229059"], ["current_step_name", nil], ["hero_id", 140], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "TestHelpersWorkflow"], ["updated_at", "2025-12-17 15:41:34.229059"]]
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 110], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.230531"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.229436"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.230531"], ["workflow_id", 110]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.231011"], ["id", 110]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 4dd57339-f0d6-4dd0-85c6-07f0e233c3c7) to Test(default) with arguments: 184
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "4dd57339-f0d6-4dd0-85c6-07f0e233c3c7"], ["updated_at", "2025-12-17 15:41:34.231400"], ["id", 184]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 110], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 184], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.233462"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.233553"], ["id", 184]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.234377"], ["id", 110]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 140], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 184], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.235608"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.235694"], ["id", 184]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.236498"], ["id", 110]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 110], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.238072"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.236853"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.238072"], ["workflow_id", 110]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_two"], ["updated_at", "2025-12-17 15:41:34.238522"], ["id", 110]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: f2e88dd6-b91c-4bb2-94a0-1696707bbdef) to Test(default) with arguments: 185
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "f2e88dd6-b91c-4bb2-94a0-1696707bbdef"], ["updated_at", "2025-12-17 15:41:34.238919"], ["id", 185]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 110], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 185], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.240768"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.240858"], ["id", 185]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.241696"], ["id", 110]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 140], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 185], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.242884"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.242998"], ["id", 185]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.243834"], ["id", 110]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 110], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.245366"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.244181"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.245366"], ["workflow_id", 110]]
  [1m[36mTestHelpersWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_three"], ["updated_at", "2025-12-17 15:41:34.245795"], ["id", 110]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: e33e0f49-874c-4373-95a3-f23b79c3454d) to Test(default) with arguments: 186
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "e33e0f49-874c-4373-95a3-f23b79c3454d"], ["updated_at", "2025-12-17 15:41:34.246174"], ["id", 186]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 110], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 186], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "started_at" = $1, "state" = $2, "updated_at" = $3 WHERE "geneva_drive_step_executions"."id" = $4[0m  [["started_at", "2025-12-17 15:41:34.247783"], ["state", "executing"], ["updated_at", "2025-12-17 15:41:34.247869"], ["id", 186]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "performing"], ["updated_at", "2025-12-17 15:41:34.248671"], ["id", 110]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 140], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 110], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 186], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.249892"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.249980"], ["id", 186]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["state", "ready"], ["updated_at", "2025-12-17 15:41:34.250932"], ["id", 110]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.3ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.251888"], ["updated_at", "2025-12-17 15:41:34.251946"], ["id", 110]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTestHelpersWorkflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["type", "TestHelpersWorkflow"], ["id", 110], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------
WorkflowTest: test_step_definitions_are_inherited
-------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.253591"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.253591"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_step_collection_provides_ordered_steps
---------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.254430"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.254430"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------------
WorkflowTest: test_workflow_with_wait_schedules_step_for_future
---------------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.255249"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.255249"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.257059"], ["current_step_name", nil], ["hero_id", 143], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "WaitingWorkflow"], ["updated_at", "2025-12-17 15:41:34.257059"]]
  [1m[36mWaitingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 111], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 111], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 111], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.258732"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.257473"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "immediate_step"], ["updated_at", "2025-12-17 15:41:34.258732"], ["workflow_id", 111]]
  [1m[36mWaitingWorkflow Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "immediate_step"], ["updated_at", "2025-12-17 15:41:34.259178"], ["id", 111]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: cc74b35d-9057-4fbf-84ea-81f165712cf9) to Test(default) with arguments: 187
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "cc74b35d-9057-4fbf-84ea-81f165712cf9"], ["updated_at", "2025-12-17 15:41:34.259615"], ["id", 187]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 111], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 187], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "completed_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["completed_at", "2025-12-17 15:41:34.260809"], ["outcome", "success"], ["state", "completed"], ["updated_at", "2025-12-17 15:41:34.260893"], ["id", 187]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 111], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mWaitingWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "WaitingWorkflow"], ["id", 111], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 111], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 111], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.263116"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-19 15:41:34.261868"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "delayed_step"], ["updated_at", "2025-12-17 15:41:34.263116"], ["workflow_id", 111]]
  [1m[36mWaitingWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "delayed_step"], ["updated_at", "2025-12-17 15:41:34.263554"], ["id", 111]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: b2ae547e-b162-404e-8d68-cd78f46f87ae) to Test(default) at 2025-12-19 15:41:34 UTC with arguments: 188
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "b2ae547e-b162-404e-8d68-cd78f46f87ae"], ["updated_at", "2025-12-17 15:41:34.263970"], ["id", 188]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" DESC LIMIT $2[0m  [["workflow_id", 111], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_cancel_if_conditions_are_inherited
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.265288"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.265288"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------------
WorkflowTest: test_may_proceed_without_hero!_is_inherited
---------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.266156"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.266156"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------------------
WorkflowTest: test_creates_workflow_with_hero_and_schedules_first_step
----------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.266980"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.266980"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.268450"], ["current_step_name", nil], ["hero_id", 146], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:41:34.268450"]]
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 112], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 112], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 112], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.270147"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.268890"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.270147"], ["workflow_id", 112]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.270573"], ["id", 112]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 47a6c330-503a-4b0a-9cb0-4fb1c2717775) to Test(default) with arguments: 189
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "47a6c330-503a-4b0a-9cb0-4fb1c2717775"], ["updated_at", "2025-12-17 15:41:34.270951"], ["id", 189]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 112]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $2[0m  [["workflow_id", 112], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
----------------------------------------------------------
WorkflowTest: test_resume!_raises_for_non-paused_workflows
----------------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.272315"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.272315"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.272832"], ["current_step_name", nil], ["hero_id", 147], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:41:34.272832"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 113], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 113], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 113], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.274299"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.273198"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.274299"], ["workflow_id", 113]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.274703"], ["id", 113]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 7ed8540f-d88b-4334-a8d3-680c5cc920e1) to Test(default) with arguments: 190
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "7ed8540f-d88b-4334-a8d3-680c5cc920e1"], ["updated_at", "2025-12-17 15:41:34.275074"], ["id", 190]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
----------------------------------------
WorkflowTest: test_scopes_work_correctly
----------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.275882"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.275882"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.276311"], ["current_step_name", nil], ["hero_id", 148], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:41:34.276311"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 114], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 114], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 114], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.277733"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.276655"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.277733"], ["workflow_id", 114]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.278168"], ["id", 114]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 69735821-3f0d-4686-b4c0-8500437a7491) to Test(default) with arguments: 191
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "69735821-3f0d-4686-b4c0-8500437a7491"], ["updated_at", "2025-12-17 15:41:34.278551"], ["id", 191]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", true], ["created_at", "2025-12-17 15:41:34.279006"], ["current_step_name", nil], ["hero_id", 148], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:41:34.279006"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 115], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 115], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 115], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.280518"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.279404"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.280518"], ["workflow_id", 115]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.281020"], ["id", 115]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 3a212862-c736-427e-bb3a-9355ba1e5c28) to Test(default) with arguments: 192
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "3a212862-c736-427e-bb3a-9355ba1e5c28"], ["updated_at", "2025-12-17 15:41:34.281381"], ["id", 192]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 115], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.282128"], ["updated_at", "2025-12-17 15:41:34.282191"], ["id", 115]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "ready"], ["id", 114], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3[0m  [["state", "finished"], ["id", 115], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 114], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Exists? (0.1ms)[0m  [1m[34mSELECT 1 AS one FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."state" NOT IN ($1, $2) AND "geneva_drive_workflows"."id" = $3 LIMIT $4[0m  [["state", "finished"], ["state", "canceled"], ["id", 115], ["LIMIT", 1]]
  [1m[36mGenevaDrive::Workflow Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."hero_type" = $1 AND "geneva_drive_workflows"."hero_id" = $2[0m  [["hero_type", "User"], ["hero_id", 148]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
WorkflowTest: test_step_collection_finds_next_step
--------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.284317"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.284317"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_resume!_works_for_paused_workflows
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.285058"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.285058"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.285553"], ["current_step_name", nil], ["hero_id", 150], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:41:34.285553"]]
  [1m[36mSimpleWorkflow Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 116], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 116], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 116], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.287081"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.285913"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.287081"], ["workflow_id", 116]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.287507"], ["id", 116]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: ec5d6e67-8e28-4822-936c-1c28ac189d43) to Test(default) with arguments: 193
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "ec5d6e67-8e28-4822-936c-1c28ac189d43"], ["updated_at", "2025-12-17 15:41:34.287857"], ["id", 193]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 116], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "paused"], ["transitioned_at", "2025-12-17 15:41:34.288632"], ["updated_at", "2025-12-17 15:41:34.288699"], ["id", 116]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 116], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "ready"], ["transitioned_at", nil], ["updated_at", "2025-12-17 15:41:34.289491"], ["id", 116]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 116], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 116], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::StepExecution Load (0.1ms)[0m  [1m[37mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 193], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Update (0.2ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "canceled_at" = $1, "outcome" = $2, "state" = $3, "updated_at" = $4 WHERE "geneva_drive_step_executions"."id" = $5[0m  [["canceled_at", "2025-12-17 15:41:34.290989"], ["outcome", "canceled"], ["state", "canceled"], ["updated_at", "2025-12-17 15:41:34.291080"], ["id", 193]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 116], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.291762"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.289861"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.291762"], ["workflow_id", 116]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 068ff84c-a80f-41cb-bbc3-9aba8e3a088e) to Test(default) with arguments: 194
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "068ff84c-a80f-41cb-bbc3-9aba8e3a088e"], ["updated_at", "2025-12-17 15:41:34.292307"], ["id", 194]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mGenevaDrive::StepExecution Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1[0m  [["workflow_id", 116]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-------------------------------------------------------------------------------
WorkflowTest: test_transitioned_at_is_set_when_transitioning_to_terminal_states
-------------------------------------------------------------------------------
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.293373"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.293373"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_workflows" ("allow_multiple", "created_at", "current_step_name", "hero_id", "hero_type", "started_at", "state", "transitioned_at", "type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"[0m  [["allow_multiple", false], ["created_at", "2025-12-17 15:41:34.293823"], ["current_step_name", nil], ["hero_id", 151], ["hero_type", "User"], ["started_at", nil], ["state", "ready"], ["transitioned_at", nil], ["type", "SimpleWorkflow"], ["updated_at", "2025-12-17 15:41:34.293823"]]
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 117], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Load (0.2ms)[0m  [1m[34mSELECT "geneva_drive_step_executions".* FROM "geneva_drive_step_executions" WHERE "geneva_drive_step_executions"."workflow_id" = $1 AND "geneva_drive_step_executions"."state" IN ($2, $3) ORDER BY "geneva_drive_step_executions"."id" ASC LIMIT $4[0m  [["workflow_id", 117], ["state", "scheduled"], ["state", "executing"], ["LIMIT", 1000]]
  [1m[36mGenevaDrive::Workflow Load (0.1ms)[0m  [1m[34mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."id" = $1 LIMIT $2[0m  [["id", 117], ["LIMIT", 1]]
  [1m[36mGenevaDrive::StepExecution Create (0.2ms)[0m  [1m[32mINSERT INTO "geneva_drive_step_executions" ("canceled_at", "completed_at", "created_at", "error_backtrace", "error_message", "failed_at", "job_id", "outcome", "scheduled_for", "skipped_at", "started_at", "state", "step_name", "updated_at", "workflow_id") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15) RETURNING "id"[0m  [["canceled_at", nil], ["completed_at", nil], ["created_at", "2025-12-17 15:41:34.295265"], ["error_backtrace", nil], ["error_message", nil], ["failed_at", nil], ["job_id", nil], ["outcome", nil], ["scheduled_for", "2025-12-17 15:41:34.294184"], ["skipped_at", nil], ["started_at", nil], ["state", "scheduled"], ["step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.295265"], ["workflow_id", 117]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "current_step_name" = $1, "updated_at" = $2 WHERE "geneva_drive_workflows"."id" = $3[0m  [["current_step_name", "step_one"], ["updated_at", "2025-12-17 15:41:34.295707"], ["id", 117]]
[ActiveJob] Enqueued GenevaDrive::PerformStepJob (Job ID: 6ea95f65-840f-446b-bf4c-2bf19ad9a598) to Test(default) with arguments: 195
  [1m[36mGenevaDrive::StepExecution Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_step_executions" SET "job_id" = $1, "updated_at" = $2 WHERE "geneva_drive_step_executions"."id" = $3[0m  [["job_id", "6ea95f65-840f-446b-bf4c-2bf19ad9a598"], ["updated_at", "2025-12-17 15:41:34.296080"], ["id", 195]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSimpleWorkflow Load (0.2ms)[0m  [1m[37mSELECT "geneva_drive_workflows".* FROM "geneva_drive_workflows" WHERE "geneva_drive_workflows"."type" = $1 AND "geneva_drive_workflows"."id" = $2 LIMIT $3 FOR UPDATE[0m  [["type", "SimpleWorkflow"], ["id", 117], ["LIMIT", 1]]
  [1m[36mSimpleWorkflow Update (0.1ms)[0m  [1m[33mUPDATE "geneva_drive_workflows" SET "state" = $1, "transitioned_at" = $2, "updated_at" = $3 WHERE "geneva_drive_workflows"."id" = $4[0m  [["state", "finished"], ["transitioned_at", "2025-12-17 15:41:34.296828"], ["updated_at", "2025-12-17 15:41:34.296889"], ["id", 117]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
-----------------------------------------------------
WorkflowTest: test_job_options_are_merged_from_parent
-----------------------------------------------------
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("active", "created_at", "email", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["active", true], ["created_at", "2025-12-17 15:41:34.297681"], ["email", "[FILTERED]"], ["name", "Test User"], ["updated_at", "2025-12-17 15:41:34.297681"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
